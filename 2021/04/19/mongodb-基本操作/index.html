<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="å°æ—"><meta name="copyright" content="å°æ—"><meta name="generator" content="Hexo 5.4.1"><meta name="theme" content="hexo-theme-yun"><title>mongodb-åŸºæœ¬æ“ä½œ | å°æ—ã®ç©ºä¸­åŸºåœ°</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/star-markdown-css@0.2.4/dist/yun/yun-markdown.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prism-theme-vars/base.css"><script src="//at.alicdn.com/t/font_1140697_dxory92pb0h.js" async></script><script src="https://cdn.jsdelivr.net/npm/@unocss/runtime/mini.global.js"></script><script src="https://cdn.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".markdown-body img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link rel="icon" type="image/png" href="/favicon.ico"><link rel="mask-icon" href="/favicon.ico" color="#0078E7"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><script id="yun-config">
    window.Yun = {}
    window.CONFIG = {"hostname":"example.com","root":"/","title":"å°æ—ã®ç©ºä¸­åŸºåœ°","version":"1.9.1","mode":"auto","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}.","hits":"${hits} results found","hits_time":"${hits} results found in ${time} ms"},"anonymous_image":"https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/avatar/none.jpg","say":{"api":"https://el-bot-api.vercel.app/api/words/young"},"fireworks":{"colors":null},"vendors":{"darken":"https://cdn.jsdelivr.net/npm/darken@1.5.0"}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/hexo-theme-yun.js" type="module"></script><link rel="preconnect" href="https://www.google-analytics.com" crossorigin><script async src="https://www.googletagmanager.com/gtag/js?id=G-1LL0D86CY9"></script><script>if (CONFIG.hostname === location.hostname) {
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-1LL0D86CY9');
}</script><script data-ad-client="ca-pub-2245427233262012" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(function(){
  var bp = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  if (curProtocol === 'https') {
    bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else {
    bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(bp, s);
})();</script><!-- Google Tag Manager --><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-M9KWR9L');</script><!-- End Google Tag Manager --><meta name="description" content="MongoDBMongoDBä»‹ç»12345678éå…³ç³»å‹æ•°æ®åº“ï¼ˆå­˜å‚¨æ•°æ®ï¼Œjsonæ ¼å¼å­˜å‚¨ï¼‰è·Ÿéå…³ç³»æ•°æ®åº“çš„å¯¹åº”å…³ç³»mysql					mongodb	 åº“						  åº“ è¡¨						è¡¨&#x2F;é›†åˆè¡Œæ•°æ®					 æ–‡æ¡£ï¼ˆjsonï¼‰ä¸æ”¯æŒè¿è¡¨æ“ä½œï¼Œæœ‰ç´¢å¼•ï¼Œé»˜è®¤_idå­—æ®µä¸ºç´¢å¼•å­—æ®µï¼Œè‡ªåŠ¨å°†å…¶å‡ä¸ºä¸»é”®  å®‰è£…&amp;é…ç½®1234567891011121314151617181920212223242">
<meta property="og:type" content="article">
<meta property="og:title" content="mongodb-åŸºæœ¬æ“ä½œ">
<meta property="og:url" content="http://example.com/2021/04/19/mongodb-%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/index.html">
<meta property="og:site_name" content="å°æ—ã®ç©ºä¸­åŸºåœ°">
<meta property="og:description" content="MongoDBMongoDBä»‹ç»12345678éå…³ç³»å‹æ•°æ®åº“ï¼ˆå­˜å‚¨æ•°æ®ï¼Œjsonæ ¼å¼å­˜å‚¨ï¼‰è·Ÿéå…³ç³»æ•°æ®åº“çš„å¯¹åº”å…³ç³»mysql					mongodb	 åº“						  åº“ è¡¨						è¡¨&#x2F;é›†åˆè¡Œæ•°æ®					 æ–‡æ¡£ï¼ˆjsonï¼‰ä¸æ”¯æŒè¿è¡¨æ“ä½œï¼Œæœ‰ç´¢å¼•ï¼Œé»˜è®¤_idå­—æ®µä¸ºç´¢å¼•å­—æ®µï¼Œè‡ªåŠ¨å°†å…¶å‡ä¸ºä¸»é”®  å®‰è£…&amp;é…ç½®1234567891011121314151617181920212223242">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2021-04-19T08:28:50.000Z">
<meta property="article:modified_time" content="2022-03-21T07:12:36.875Z">
<meta property="article:author" content="å°æ—">
<meta property="article:tag" content="mongodb">
<meta name="twitter:card" content="summary"><script>(function() {
  const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
  const setting = localStorage.getItem('darken-mode') || 'auto'
  if (setting === 'dark' || (prefersDark && setting !== 'light'))
    document.documentElement.classList.toggle('dark', true)
})()</script></head><body><script defer src="https://cdn.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js" type="module"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js" type="module"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="Table of Contents"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-list-ordered"></use></svg></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="Overview"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-passport-line"></use></svg></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="å°æ—"><img width="96" loading="lazy" src="/images/avatar1.jpg" alt="å°æ—"><span class="site-author-status" title="Looking for dawn.">ğŸŒ‘</span></a><div class="site-author-name"><a href="/about/">å°æ—</a></div><span class="site-name">å°æ—ã®ç©ºä¸­åŸºåœ°</span><sub class="site-subtitle">You're always there for me.</sub><div class="site-description">ç»å†é£é›¨æœªå¿…ç°å½©è™¹ï¼Œä½†å½©è™¹æ€»åœ¨é£é›¨å</div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="Home"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-home-4-line"></use></svg></span></a><div class="site-state-item"><a href="/archives/" title="Archives"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-archive-line"></use></svg></span><span class="site-state-item-count">45</span></a></div><div class="site-state-item"><a href="/categories/" title="Categories"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-2-line"></use></svg></span><span class="site-state-item-count">0</span></a></div><div class="site-state-item"><a href="/tags/" title="Tags"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="site-state-item-count">13</span></a></div><a class="site-state-item hty-icon-button" href="/about/#comment" title="ç•™è¨€æ¿"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-clipboard-line"></use></svg></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/xiaolin-666" title="GitHub" target="_blank" style="color:#6e5494"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-github-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://music.163.com/#/user/home?id=1293010382" title="ç½‘æ˜“äº‘éŸ³ä¹" target="_blank" style="color:#C20C0C"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-netease-cloud-music-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://space.bilibili.com/21350202" title="å“”å“©å“”å“©" target="_blank" style="color:#FF8EB3"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-bilibili-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://twitter.com" title="Twitter" target="_blank" style="color:#1da1f2"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-twitter-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://t.me/elpsycn" title="Telegram Channel" target="_blank" style="color:#0088CC"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-telegram-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="mailto:me@xiaolin.cn" title="E-Mail" target="_blank" style="color:#8E71C1"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-mail-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://travellings.link" title="Travelling" target="_blank" style="color:var(--hty-text-color)"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-train-line"></use></svg></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="æˆ‘çš„å°ä¼™ä¼´ä»¬" style="color:dodgerblue"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-genderless-line"></use></svg></a><a class="links-item hty-icon-button" href="/girls/" title="å–œæ¬¢çš„å¥³å­©å­" style="color:hotpink"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-women-line"></use></svg></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-contrast-2-line"></use></svg></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#MongoDB"><span class="toc-number">1.</span> <span class="toc-text">MongoDB</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#MongoDB%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.1.</span> <span class="toc-text">MongoDBä»‹ç»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-amp-%E9%85%8D%E7%BD%AE"><span class="toc-number">1.2.</span> <span class="toc-text">å®‰è£…&amp;é…ç½®</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B4%A6%E5%8F%B7%E7%AE%A1%E7%90%86"><span class="toc-number">1.2.1.</span> <span class="toc-text">è´¦å·ç®¡ç†</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">2.</span> <span class="toc-text">åŸºæœ¬æ•°æ®ç±»å‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CURD%E6%93%8D%E4%BD%9C"><span class="toc-number">3.</span> <span class="toc-text">CURDæ“ä½œ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C"><span class="toc-number">3.1.</span> <span class="toc-text">æ•°æ®åº“æ“ä½œ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9B%86%E5%90%88%E6%93%8D%E4%BD%9C%EF%BC%88%E8%A1%A8%EF%BC%89"><span class="toc-number">3.2.</span> <span class="toc-text">é›†åˆæ“ä½œï¼ˆè¡¨ï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E6%A1%A3%E6%93%8D%E4%BD%9C"><span class="toc-number">3.3.</span> <span class="toc-text">æ–‡æ¡£æ“ä½œ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%B0%E5%A2%9E%E6%96%87%E6%A1%A3"><span class="toc-number">3.3.1.</span> <span class="toc-text">æ–°å¢æ–‡æ¡£</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E6%96%87%E6%A1%A3"><span class="toc-number">3.3.2.</span> <span class="toc-text">æŸ¥è¯¢æ–‡æ¡£</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E6%96%87%E6%A1%A3"><span class="toc-number">3.3.3.</span> <span class="toc-text">ä¿®æ”¹æ–‡æ¡£</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E6%96%87%E6%A1%A3"><span class="toc-number">3.3.4.</span> <span class="toc-text">åˆ é™¤æ–‡æ¡£</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%81%9A%E5%90%88"><span class="toc-number">3.3.5.</span> <span class="toc-text">èšåˆ</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Pymongo"><span class="toc-number">4.</span> <span class="toc-text">Pymongo</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%83%E4%B9%A0%E9%A2%98"><span class="toc-number">5.</span> <span class="toc-text">ç»ƒä¹ é¢˜</span></a></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article" style="--smc-primary:#0078E7;"><link itemprop="mainEntityOfPage" href="http://example.com/2021/04/19/mongodb-%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="å°æ—"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="å°æ—ã®ç©ºä¸­åŸºåœ°"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">mongodb-åŸºæœ¬æ“ä½œ<a class="post-edit-link" href="https://github.com/xiaolin-666/xiaolin-666.github.io/tree/hexo/source/_posts/mongodb-åŸºæœ¬æ“ä½œ.md" target="_blank" title="Edit this post" rel="noopener"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-edit-line"></use></svg></a></h1><div class="post-meta"><div class="post-time"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-line"></use></svg></span> <time title="Created: 2021-04-19 16:28:50" itemprop="dateCreated datePublished" datetime="2021-04-19T16:28:50+08:00">2021-04-19</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-2-line"></use></svg></span> <time title="Modified: 2022-03-21 15:12:36" itemprop="dateModified" datetime="2022-03-21T15:12:36+08:00">2022-03-21</time></div><div class="post-classify"><span class="post-tag"><a class="tag-item" href="/tags/mongodb/" style="--text-color:#ccb44b"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">mongodb</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body"><h2 id="MongoDB"><a href="#MongoDB" class="headerlink" title="MongoDB"></a>MongoDB</h2><h3 id="MongoDBä»‹ç»"><a href="#MongoDBä»‹ç»" class="headerlink" title="MongoDBä»‹ç»"></a>MongoDBä»‹ç»</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">éå…³ç³»å‹æ•°æ®åº“ï¼ˆå­˜å‚¨æ•°æ®ï¼Œjsonæ ¼å¼å­˜å‚¨ï¼‰</span><br><span class="line">è·Ÿéå…³ç³»æ•°æ®åº“çš„å¯¹åº”å…³ç³»</span><br><span class="line">mysql					mongodb	</span><br><span class="line"> åº“						  åº“</span><br><span class="line"> è¡¨						è¡¨/é›†åˆ</span><br><span class="line">è¡Œæ•°æ®					 æ–‡æ¡£ï¼ˆjsonï¼‰</span><br><span class="line"></span><br><span class="line">ä¸æ”¯æŒè¿è¡¨æ“ä½œï¼Œæœ‰ç´¢å¼•ï¼Œé»˜è®¤_idå­—æ®µä¸ºç´¢å¼•å­—æ®µï¼Œè‡ªåŠ¨å°†å…¶å‡ä¸ºä¸»é”®</span><br></pre></td></tr></table></figure>

<h3 id="å®‰è£…-amp-é…ç½®"><a href="#å®‰è£…-amp-é…ç½®" class="headerlink" title="å®‰è£…&amp;é…ç½®"></a>å®‰è£…&amp;é…ç½®</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">ä¸‹è½½åœ°å€ https:<span class="comment">//www.mongodb.com/download-center/communityï¼Œé€‰æ‹©å¹³å°ä¸‹è½½</span></span><br><span class="line"></span><br><span class="line"><span class="number">1.</span>å®‰è£…ï¼Œä¸€è·¯ä¸‹ä¸€æ­¥</span><br><span class="line"><span class="number">2.</span>ä¼šè‡ªåŠ¨åˆ›å»ºæ–‡ä»¶dbå’Œmongod.logæ–‡ä»¶,è‡ªåŠ¨åˆ›å»ºæœåŠ¡</span><br><span class="line"><span class="number">3.</span>æ³¨æ„binè·¯å¾„ä¸‹çš„é…ç½®æ–‡ä»¶mongod.cfg</span><br><span class="line">    storage:</span><br><span class="line">      dbPath: C:\Program Files\MongoDB\Server\<span class="number">4.2</span>\data</span><br><span class="line">      journal:</span><br><span class="line">        enabled: <span class="literal">true</span></span><br><span class="line">    # where to write logging data.</span><br><span class="line">    systemLog:</span><br><span class="line">      destination: file</span><br><span class="line">      logAppend: <span class="literal">true</span></span><br><span class="line">      path:  C:\Program Files\MongoDB\Server\<span class="number">4.2</span>\log\mongod.log</span><br><span class="line">    # network interfaces</span><br><span class="line">    net:</span><br><span class="line">      port: <span class="number">27017</span></span><br><span class="line">      bindIp: <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span></span><br><span class="line"><span class="number">4.</span>å¯åŠ¨\å…³é—­</span><br><span class="line">net start MongoDB</span><br><span class="line">net stop MongoDB</span><br><span class="line">mongod --config <span class="string">&quot;mongod.cfg&quot;</span> --service</span><br><span class="line"><span class="number">5.</span>ç™»å½•</span><br><span class="line">mongo</span><br><span class="line">è¿œç¨‹è¿æ¥ï¼šmongo --host <span class="number">10.0</span><span class="number">.0</span><span class="number">.5</span> --port <span class="number">27017</span></span><br><span class="line"><span class="number">6.</span>å®‰è£…robo3tï¼ˆå®¢æˆ·ç«¯ï¼Œç­‰åŒäºNavicatï¼‰</span><br></pre></td></tr></table></figure>

<h4 id="è´¦å·ç®¡ç†"><a href="#è´¦å·ç®¡ç†" class="headerlink" title="è´¦å·ç®¡ç†"></a>è´¦å·ç®¡ç†</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">Readï¼šå…è®¸ç”¨æˆ·è¯»å–æŒ‡å®šæ•°æ®åº“</span><br><span class="line">readWriteï¼šå…è®¸ç”¨æˆ·è¯»å†™æŒ‡å®šæ•°æ®åº“</span><br><span class="line">dbAdminï¼šå…è®¸ç”¨æˆ·åœ¨æŒ‡å®šæ•°æ®åº“ä¸­æ‰§è¡Œç®¡ç†å‡½æ•°ï¼Œå¦‚ç´¢å¼•åˆ›å»ºã€åˆ é™¤ï¼ŒæŸ¥çœ‹ç»Ÿè®¡æˆ–è®¿é—®system.profile</span><br><span class="line">userAdminï¼šå…è®¸ç”¨æˆ·å‘system.usersé›†åˆå†™å…¥ï¼Œå¯ä»¥æ‰¾æŒ‡å®šæ•°æ®åº“é‡Œåˆ›å»ºã€åˆ é™¤å’Œç®¡ç†ç”¨æˆ·</span><br><span class="line">clusterAdminï¼šåªåœ¨adminæ•°æ®åº“ä¸­å¯ç”¨ï¼Œèµ‹äºˆç”¨æˆ·æ‰€æœ‰åˆ†ç‰‡å’Œå¤åˆ¶é›†ç›¸å…³å‡½æ•°çš„ç®¡ç†æƒé™ã€‚</span><br><span class="line">readAnyDatabaseï¼šåªåœ¨adminæ•°æ®åº“ä¸­å¯ç”¨ï¼Œèµ‹äºˆç”¨æˆ·æ‰€æœ‰æ•°æ®åº“çš„è¯»æƒé™</span><br><span class="line">readWriteAnyDatabaseï¼šåªåœ¨adminæ•°æ®åº“ä¸­å¯ç”¨ï¼Œèµ‹äºˆç”¨æˆ·æ‰€æœ‰æ•°æ®åº“çš„è¯»å†™æƒé™</span><br><span class="line">userAdminAnyDatabaseï¼šåªåœ¨adminæ•°æ®åº“ä¸­å¯ç”¨ï¼Œèµ‹äºˆç”¨æˆ·æ‰€æœ‰æ•°æ®åº“çš„userAdminæƒé™</span><br><span class="line">dbAdminAnyDatabaseï¼šåªåœ¨adminæ•°æ®åº“ä¸­å¯ç”¨ï¼Œèµ‹äºˆç”¨æˆ·æ‰€æœ‰æ•°æ®åº“çš„dbAdminæƒé™ã€‚</span><br><span class="line">rootï¼šåªåœ¨adminæ•°æ®åº“ä¸­å¯ç”¨ã€‚è¶…çº§è´¦å·ï¼Œè¶…çº§æƒé™(æœ¬æ¬¡åˆ›å»ºçš„å°±æ˜¯è¶…çº§è´¦å·)</span><br><span class="line"></span><br><span class="line">ç®¡ç†å‘˜è´¦å·è¦å»ºåœ¨amdinåº“ä¸‹</span><br><span class="line">è¦ç®¡ç†å“ªä¸ªåº“ï¼Œå°±åœ¨å“ªä¸ªåº“ä¸‹å»ºè´¦å·,åˆ é™¤ç”¨æˆ·ï¼Œç”¨æˆ·åˆ›å»ºçš„åº“ä¹Ÿæ²¡äº†</span><br><span class="line"><span class="number">1.</span>åˆ›å»ºè´¦å·</span><br><span class="line"># åˆ‡æ¢åˆ°adminåº“ä¸‹</span><br><span class="line">use admin</span><br><span class="line"># åˆ›å»ºç”¨æˆ·èµ‹äºˆæƒé™</span><br><span class="line">db.createUser(</span><br><span class="line">  &#123;</span><br><span class="line">    user: <span class="string">&quot;root&quot;</span>,</span><br><span class="line">    pwd: <span class="string">&quot;123&quot;</span>,</span><br><span class="line">    roles: [ &#123; role: <span class="string">&quot;root&quot;</span>, db: <span class="string">&quot;admin&quot;</span> &#125; ]</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">use test # å¦‚æœæ•°æ®åº“ä¸å­˜åœ¨ï¼Œä¸ä¼šæŠ¥é”™ï¼Œä¹Ÿä¸ä¼šæ˜¾ç¤ºå‡ºï¼Œåªæœ‰æ’å…¥æ•°æ®æ‰ä¼šåˆ›å»º</span><br><span class="line">db.createUser(</span><br><span class="line">  &#123;</span><br><span class="line">    user: <span class="string">&quot;lucky&quot;</span>,</span><br><span class="line">    pwd: <span class="string">&quot;123&quot;</span>,</span><br><span class="line">    roles: [ &#123; role: <span class="string">&quot;readWrite&quot;</span>, db: <span class="string">&quot;test&quot;</span> &#125;,</span><br><span class="line">             &#123; role: <span class="string">&quot;read&quot;</span>, db: <span class="string">&quot;db1&quot;</span> &#125; ]</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br><span class="line"><span class="number">2.</span>é‡å¯æ•°æ®åº“</span><br><span class="line"><span class="number">2.1</span>åœ¨é‡å¯mongodä¹‹å‰ï¼Œä¿®æ”¹é…ç½®æ–‡ä»¶mongo.configï¼Œåœ¨æœ€ä¸‹é¢åŠ å…¥è¿™ä¹ˆä¸€è¡Œï¼Œmongodbé»˜è®¤ä¸å¯ç”¨æˆæƒè®¤è¯ï¼Œåªè¦èƒ½è¿æ¥åˆ°è¯¥æœåŠ¡å™¨ï¼Œå°±å¯è¿æ¥åˆ°mongodã€‚è‹¥è¦å¯ç”¨å®‰å…¨è®¤è¯ï¼Œéœ€è¦æ›´æ”¹é…ç½®æ–‡ä»¶å‚æ•°security:</span><br><span class="line">  authorization: enabled</span><br><span class="line"></span><br><span class="line">net stop MongoDB</span><br><span class="line">net start MongoDB</span><br><span class="line"># éœ€è¦ä»¥å¼€å¯è®¤è¯çš„æ–¹å¼å¯åŠ¨mongodbæœåŠ¡</span><br><span class="line">mongod --config <span class="string">&quot;mongod.cfg&quot;</span> --auth <span class="comment">// å¼€å¯è®¤è¯</span></span><br><span class="line"># ä»¥ç®¡ç†å‘˜ç™»é™†</span><br><span class="line">mongo -u <span class="string">&quot;root&quot;</span> -p <span class="string">&quot;123&quot;</span> --authenticationDatabase <span class="string">&quot;admin&quot;</span></span><br></pre></td></tr></table></figure>

<h2 id="åŸºæœ¬æ•°æ®ç±»å‹"><a href="#åŸºæœ¬æ•°æ®ç±»å‹" class="headerlink" title="åŸºæœ¬æ•°æ®ç±»å‹"></a>åŸºæœ¬æ•°æ®ç±»å‹</h2><p>1ã€åœ¨æ¦‚å¿µä¸Šï¼ŒMongoDBçš„æ–‡æ¡£ä¸Javascriptçš„å¯¹è±¡ç›¸è¿‘ï¼Œå› è€Œå¯ä»¥è®¤ä¸ºå®ƒç±»ä¼¼äºJSONã€‚JSONï¼ˆ<a href="http://www.json.orgï¼‰æ˜¯ä¸€ç§ç®€å•çš„æ•°æ®è¡¨ç¤ºæ–¹å¼ï¼šå…¶è§„èŒƒä»…ç”¨ä¸€æ®µæ–‡å­—å°±èƒ½æè¿°æ¸…æ¥šï¼ˆå…¶å®˜ç½‘è¯æ˜äº†è¿™ç‚¹ï¼‰ï¼Œä¸”ä»…åŒ…å«å…­ç§æ•°æ®ç±»å‹ã€‚/">http://www.json.orgï¼‰æ˜¯ä¸€ç§ç®€å•çš„æ•°æ®è¡¨ç¤ºæ–¹å¼ï¼šå…¶è§„èŒƒä»…ç”¨ä¸€æ®µæ–‡å­—å°±èƒ½æè¿°æ¸…æ¥šï¼ˆå…¶å®˜ç½‘è¯æ˜äº†è¿™ç‚¹ï¼‰ï¼Œä¸”ä»…åŒ…å«å…­ç§æ•°æ®ç±»å‹ã€‚</a></p>
<p>2ã€è¿™æ ·æœ‰å¾ˆå¤šå¥½å¤„ï¼šæ˜“äºç†è§£ã€æ˜“äºè§£æã€æ˜“äºè®°å¿†ã€‚ç„¶è€Œä»å¦ä¸€æ–¹é¢è¯´ï¼Œå› ä¸ºåªæœ‰nullã€å¸ƒå°”ã€æ•°å­—ã€å­—ç¬¦ä¸²ã€æ•°å­—å’Œå¯¹è±¡è¿™å‡ ç§æ•°æ®ç±»å‹ï¼Œæ‰€ä»¥JSONçš„è¡¨è¾¾èƒ½åŠ›æœ‰ä¸€å®šçš„å±€é™ã€‚</p>
<p>3ã€è™½ç„¶JSONå…·å¤‡çš„è¿™äº›ç±»å‹å·²ç»å…·æœ‰å¾ˆå¼ºçš„è¡¨ç°åŠ›ï¼Œä½†ç»å¤§æ•°åº”ç”¨ï¼ˆå°¤å…¶æ˜¯åœ¨äºæ•°æ®åº“æ‰“äº¤é“æ—¶ï¼‰éƒ½è¿˜éœ€è¦å…¶ä»–ä¸€äº›é‡è¦çš„ç±»å‹ã€‚ä¾‹å¦‚ï¼ŒJSONæ²¡æœ‰æ—¥æœŸç±»å‹ï¼Œè¿™ä½¿å¾—åŸæœ¬å®¹æ˜“æ—¥æœŸå¤„ç†å˜å¾—çƒ¦äººã€‚å¦å¤–ï¼ŒJSONåªæœ‰ä¸€ç§æ•°å­—ç±»å‹ï¼Œæ— æ³•åŒºåˆ†æµ®ç‚¹æ•°å’Œæ•´æ•°ï¼Œæ›´åˆ«åŒºåˆ†32ä½å’Œ64ä½äº†ã€‚å†è€…JSONæ— æ³•è¡¨ç¤ºå…¶ä»–ä¸€äº›é€šç”¨ç±»å‹ï¼Œå¦‚æ­£åˆ™è¡¨è¾¾å¼æˆ–å‡½æ•°ã€‚</p>
<p>4ã€MongoDBåœ¨ä¿ç•™äº†JSONåŸºæœ¬é”®/å€¼å¯¹ç‰¹æ€§çš„åŸºç¡€ä¸Šï¼Œæ·»åŠ äº†å…¶ä»–ä¸€äº›æ•°æ®ç±»å‹ã€‚åœ¨ä¸åŒçš„ç¼–ç¨‹è¯­è¨€ä¸‹ï¼Œè¿™äº›ç±»å‹çš„ç¡®åˆ‡è¡¨ç¤ºæœ‰äº›è®¸å·®å¼‚ã€‚ä¸‹é¢è¯´æ˜äº†MongoDBæ”¯æŒçš„å…¶ä»–é€šç”¨ç±»å‹ï¼Œä»¥åŠå¦‚ä½•æ­£åœ¨æ–‡æ¡£ä¸­ä½¿ç”¨å®ƒä»¬</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1ã€nullï¼šç”¨äºè¡¨ç¤ºç©ºæˆ–ä¸å­˜åœ¨çš„å­—æ®µ</span></span><br><span class="line">d=&#123;<span class="string">&#x27;x&#x27;</span>:null&#125;</span><br><span class="line"><span class="comment">#2ã€å¸ƒå°”å‹ï¼štrueå’Œfalse</span></span><br><span class="line">d=&#123;<span class="string">&#x27;x&#x27;</span>:<span class="literal">true</span>,<span class="string">&#x27;y&#x27;</span>:<span class="literal">false</span>&#125;</span><br><span class="line"><span class="comment">#3ã€æ•°å€¼</span></span><br><span class="line">d=&#123;<span class="string">&#x27;x&#x27;</span>:3,<span class="string">&#x27;y&#x27;</span>:3.1415926&#125;</span><br><span class="line"><span class="comment">#4ã€å­—ç¬¦ä¸²</span></span><br><span class="line">d=&#123;<span class="string">&#x27;x&#x27;</span>:<span class="string">&#x27;lucky&#x27;</span>&#125;</span><br><span class="line"><span class="comment">#5ã€æ—¥æœŸ</span></span><br><span class="line">d=&#123;<span class="string">&#x27;x&#x27;</span>:new Date()&#125;</span><br><span class="line">d.x.getHours()</span><br><span class="line"><span class="comment">#6ã€æ­£åˆ™è¡¨è¾¾å¼</span></span><br><span class="line">d=&#123;<span class="string">&#x27;pattern&#x27;</span>:/^lucky.*?nb$/i&#125;</span><br><span class="line"></span><br><span class="line">æ­£åˆ™å†™åœ¨ï¼ï¼å†…ï¼Œåé¢çš„iä»£è¡¨:</span><br><span class="line">i å¿½ç•¥å¤§å°å†™</span><br><span class="line">m å¤šè¡ŒåŒ¹é…æ¨¡å¼</span><br><span class="line">x å¿½ç•¥éè½¬ä¹‰çš„ç©ºç™½å­—ç¬¦</span><br><span class="line">s å•è¡ŒåŒ¹é…æ¨¡å¼</span><br><span class="line"></span><br><span class="line"><span class="comment">#7ã€æ•°ç»„</span></span><br><span class="line">d=&#123;<span class="string">&#x27;x&#x27;</span>:[1,<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;v&#x27;</span>]&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#8ã€å†…åµŒæ–‡æ¡£</span></span><br><span class="line">user=&#123;<span class="string">&#x27;name&#x27;</span>:<span class="string">&#x27;lucky&#x27;</span>,<span class="string">&#x27;addr&#x27;</span>:&#123;<span class="string">&#x27;country&#x27;</span>:<span class="string">&#x27;China&#x27;</span>,<span class="string">&#x27;city&#x27;</span>:<span class="string">&#x27;YT&#x27;</span>&#125;&#125;</span><br><span class="line">user.addr.country</span><br><span class="line"></span><br><span class="line"><span class="comment">#9ã€å¯¹è±¡id:æ˜¯ä¸€ä¸ª12å­—èŠ‚çš„ID,æ˜¯æ–‡æ¡£çš„å”¯ä¸€æ ‡è¯†ï¼Œä¸å¯å˜</span></span><br><span class="line">d=&#123;<span class="string">&#x27;x&#x27;</span>:ObjectId()&#125;</span><br></pre></td></tr></table></figure>

<p>_idå’ŒObjectid</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">MongoDBä¸­å­˜å‚¨çš„æ–‡æ¡£å¿…é¡»æœ‰ä¸€ä¸ª<span class="string">&quot;_id&quot;</span>é”®ã€‚è¿™ä¸ªé”®çš„å€¼å¯ä»¥æ˜¯ä»»æ„ç±»å‹ï¼Œé»˜è®¤æ˜¯ä¸ªObjectIdå¯¹è±¡ã€‚</span><br><span class="line">åœ¨ä¸€ä¸ªé›†åˆé‡Œï¼Œæ¯ä¸ªæ–‡æ¡£éƒ½æœ‰å”¯ä¸€çš„â€œ_idâ€,ç¡®ä¿é›†åˆé‡Œæ¯ä¸ªæ–‡æ¡£éƒ½èƒ½è¢«å”¯ä¸€æ ‡è¯†ã€‚</span><br><span class="line">ä¸åŒé›†åˆ<span class="string">&quot;_id&quot;</span>çš„å€¼å¯ä»¥é‡å¤ï¼Œä½†åŒä¸€é›†åˆå†…<span class="string">&quot;_id&quot;</span>çš„å€¼å¿…é¡»å”¯ä¸€</span><br><span class="line"></span><br><span class="line"><span class="comment">#1ã€ObjectId</span></span><br><span class="line">ObjectIdæ˜¯<span class="string">&quot;_id&quot;</span>çš„é»˜è®¤ç±»å‹ã€‚å› ä¸ºè®¾è®¡MongoDbçš„åˆè¡·å°±æ˜¯ç”¨ä½œåˆ†å¸ƒå¼æ•°æ®åº“ï¼Œæ‰€ä»¥èƒ½å¤Ÿåœ¨åˆ†ç‰‡ç¯å¢ƒä¸­ç”Ÿæˆ</span><br><span class="line">å”¯ä¸€çš„æ ‡è¯†ç¬¦éå¸¸é‡è¦ï¼Œè€Œå¸¸è§„çš„åšæ³•ï¼šåœ¨å¤šä¸ªæœåŠ¡å™¨ä¸ŠåŒæ­¥è‡ªåŠ¨å¢åŠ ä¸»é”®æ—¢è´¹æ—¶åˆè´¹åŠ›ï¼Œè¿™å°±æ˜¯MongoDBé‡‡ç”¨</span><br><span class="line">ObjectIdçš„åŸå› ã€‚</span><br><span class="line">ObjectIdé‡‡ç”¨12å­—èŠ‚çš„å­˜å‚¨ç©ºé—´ï¼Œæ˜¯ä¸€ä¸ªç”±24ä¸ªåå…­è¿›åˆ¶æ•°å­—ç»„æˆçš„å­—ç¬¦ä¸²</span><br><span class="line">    0|1|2|3|   4|5|6|     7|8    9|10|11    </span><br><span class="line">    æ—¶é—´æˆ³      æœºå™¨      PID    è®¡æ•°å™¨</span><br><span class="line">å¦‚æœå¿«é€Ÿåˆ›å»ºå¤šä¸ªObjectIdï¼Œä¼šå‘ç°æ¯æ¬¡åªæœ‰æœ€åå‡ ä½æœ‰å˜åŒ–ã€‚å¦å¤–ï¼Œä¸­é—´çš„å‡ ä½æ•°å­—ä¹Ÿä¼šå˜åŒ–ï¼ˆè¦æ˜¯åœ¨åˆ›å»ºè¿‡ç¨‹ä¸­åœé¡¿å‡ ç§’ï¼‰ã€‚</span><br><span class="line">è¿™æ˜¯ObjectIdçš„åˆ›å»ºæ–¹å¼å¯¼è‡´çš„ï¼Œå¦‚ä¸Šå›¾</span><br><span class="line"></span><br><span class="line">æ—¶é—´æˆ³å•ä½ä¸ºç§’ï¼Œä¸éšå5ä¸ªå­—èŠ‚ç»„åˆèµ·æ¥ï¼Œæä¾›äº†ç§’çº§çš„å”¯ä¸€æ€§ã€‚è¿™ä¸ª4ä¸ªå­—èŠ‚éšè—äº†æ–‡æ¡£çš„åˆ›å»ºæ—¶é—´ï¼Œç»å¤§å¤šæ•°é©±åŠ¨ç¨‹åºéƒ½ä¼šæä¾›</span><br><span class="line">ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºä»ObjectIdä¸­è·å–è¿™äº›ä¿¡æ¯ã€‚</span><br><span class="line"></span><br><span class="line">å› ä¸ºä½¿ç”¨çš„æ˜¯å½“å‰æ—¶é—´ï¼Œå¾ˆå¤šç”¨æˆ·æ‹…å¿ƒè¦å¯¹æœåŠ¡å™¨è¿›è¡Œæ—¶é’ŸåŒæ­¥ã€‚å…¶å®æ²¡å¿…è¦ï¼Œå› ä¸ºæ—¶é—´æˆ³çš„å®é™…å€¼å¹¶ä¸é‡è¦ï¼Œåªè¦å®ƒæ€»æ˜¯ä¸åœå¢åŠ å°±å¥½ã€‚</span><br><span class="line">æ¥ä¸‹æ¥3ä¸ªå­—èŠ‚æ˜¯æ‰€åœ¨ä¸»æœºçš„å”¯ä¸€æ ‡è¯†ç¬¦ã€‚é€šå¸¸æ˜¯æœºå™¨ä¸»æœºåçš„æ•£åˆ—å€¼ã€‚è¿™æ ·å°±å¯ä»¥ä¿è¯ä¸åŒä¸»æœºç”Ÿæˆä¸åŒçš„ObjectIdï¼Œä¸äº§ç”Ÿå†²çª</span><br><span class="line"></span><br><span class="line">æ¥ä¸‹æ¥è¿ä¸ªå­—èŠ‚ç¡®ä¿äº†åœ¨åŒä¸€å°æœºå™¨ä¸Šå¹¶å‘çš„å¤šä¸ªè¿›ç¨‹äº§ç”Ÿçš„ObjectIdæ˜¯å”¯ä¸€çš„</span><br><span class="line"></span><br><span class="line">å‰9ä¸ªå­—èŠ‚ç¡®ä¿äº†åŒä¸€ç§’é’Ÿä¸åŒæœºå™¨ä¸åŒè¿›ç¨‹äº§ç”Ÿçš„ObjectIdæ˜¯å”¯ä¸€çš„ã€‚æœ€å3ä¸ªå­—èŠ‚æ˜¯ä¸€ä¸ªè‡ªåŠ¨å¢åŠ çš„ è®¡æ•°å™¨ã€‚ç¡®ä¿ç›¸åŒè¿›ç¨‹çš„åŒä¸€ç§’äº§ç”Ÿçš„</span><br><span class="line">ObjectIdä¹Ÿæ˜¯ä¸ä¸€æ ·çš„ã€‚</span><br><span class="line"></span><br><span class="line"><span class="comment">#2ã€è‡ªåŠ¨ç”Ÿæˆ_id</span></span><br><span class="line">å¦‚æœæ’å…¥æ–‡æ¡£æ—¶æ²¡æœ‰<span class="string">&quot;_id&quot;</span>é”®ï¼Œç³»ç»Ÿä¼šè‡ªå¸®ä½ åˆ›å»º ä¸€ä¸ªã€‚å¯ä»¥ç”±MongoDbæœåŠ¡å™¨æ¥åšè¿™ä»¶äº‹ã€‚</span><br><span class="line">ä½†é€šå¸¸ä¼šåœ¨å®¢æˆ·ç«¯ç”±é©±åŠ¨ç¨‹åºå®Œæˆã€‚è¿™ä¸€åšæ³•éå¸¸å¥½åœ°ä½“ç°äº†MongoDbçš„å“²å­¦ï¼šèƒ½äº¤ç»™å®¢æˆ·ç«¯é©±åŠ¨ç¨‹åºæ¥åšçš„äº‹æƒ…å°±ä¸è¦äº¤ç»™æœåŠ¡å™¨æ¥åšã€‚</span><br><span class="line">è¿™ç§ç†å¿µèƒŒåçš„åŸå› æ˜¯ï¼šå³ä¾¿æ˜¯åƒMongoDBè¿™æ ·æ‰©å±•æ€§éå¸¸å¥½çš„æ•°æ®åº“ï¼Œæ‰©å±•åº”ç”¨å±‚ä¹Ÿè¦æ¯”æ‰©å±•æ•°æ®åº“å±‚å®¹æ˜“çš„å¤šã€‚å°†å·¥ä½œäº¤ç»™å®¢æˆ·ç«¯åšå°±</span><br><span class="line">å‡è½»äº†æ•°æ®åº“æ‰©å±•çš„è´Ÿæ‹…ã€‚</span><br></pre></td></tr></table></figure>

<h2 id="CURDæ“ä½œ"><a href="#CURDæ“ä½œ" class="headerlink" title="CURDæ“ä½œ"></a>CURDæ“ä½œ</h2><h3 id="æ•°æ®åº“æ“ä½œ"><a href="#æ•°æ®åº“æ“ä½œ" class="headerlink" title="æ•°æ®åº“æ“ä½œ"></a>æ•°æ®åº“æ“ä½œ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1ã€å¢</span></span><br><span class="line">use config <span class="comment">#å¦‚æœæ•°æ®åº“ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºæ•°æ®åº“ï¼Œå¦åˆ™åˆ‡æ¢åˆ°æŒ‡å®šæ•°æ®åº“ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#2ã€æŸ¥</span></span><br><span class="line">show dbs <span class="comment">#æŸ¥çœ‹æ‰€æœ‰</span></span><br><span class="line">å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬åˆšåˆ›å»ºçš„æ•°æ®åº“configå¹¶ä¸åœ¨æ•°æ®åº“çš„åˆ—è¡¨ä¸­ï¼Œ è¦æ˜¾ç¤ºå®ƒï¼Œæˆ‘ä»¬éœ€è¦å‘configæ•°æ®åº“æ’å…¥ä¸€äº›æ•°æ®ã€‚</span><br><span class="line">db.table1.insert(&#123;<span class="string">&#x27;a&#x27;</span>:1&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">#3ã€åˆ </span></span><br><span class="line">use config <span class="comment">#å…ˆåˆ‡æ¢åˆ°è¦åˆ çš„åº“ä¸‹</span></span><br><span class="line">db.dropDatabase() <span class="comment">#åˆ é™¤å½“å‰åº“</span></span><br></pre></td></tr></table></figure>

<h3 id="é›†åˆæ“ä½œï¼ˆè¡¨ï¼‰"><a href="#é›†åˆæ“ä½œï¼ˆè¡¨ï¼‰" class="headerlink" title="é›†åˆæ“ä½œï¼ˆè¡¨ï¼‰"></a>é›†åˆæ“ä½œï¼ˆè¡¨ï¼‰</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1ã€å¢</span></span><br><span class="line">å½“ç¬¬ä¸€ä¸ªæ–‡æ¡£æ’å…¥æ—¶ï¼Œé›†åˆå°±ä¼šè¢«åˆ›å»º</span><br><span class="line">&gt; use database1</span><br><span class="line">switched to db database1</span><br><span class="line">&gt; db.table1.insert(&#123;<span class="string">&#x27;a&#x27;</span>:1&#125;)</span><br><span class="line">WriteResult(&#123; <span class="string">&quot;nInserted&quot;</span> : 1 &#125;)</span><br><span class="line">&gt; db.table2.insert(&#123;<span class="string">&#x27;b&#x27;</span>:2&#125;)</span><br><span class="line">WriteResult(&#123; <span class="string">&quot;nInserted&quot;</span> : 1 &#125;)</span><br><span class="line"><span class="comment">#æ³¨æ„ db.userå’Œdb.user.infoæ˜¯ä¸¤ä¸ªè¡¨</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#2ã€æŸ¥</span></span><br><span class="line">&gt; show collections</span><br><span class="line">&gt; show tables</span><br><span class="line">table1</span><br><span class="line">table2</span><br><span class="line"></span><br><span class="line"><span class="comment">#3ã€åˆ </span></span><br><span class="line">&gt; db.table1.drop()</span><br><span class="line"><span class="literal">true</span></span><br><span class="line">&gt; show tables</span><br><span class="line">table2</span><br></pre></td></tr></table></figure>

<h3 id="æ–‡æ¡£æ“ä½œ"><a href="#æ–‡æ¡£æ“ä½œ" class="headerlink" title="æ–‡æ¡£æ“ä½œ"></a>æ–‡æ¡£æ“ä½œ</h3><h4 id="æ–°å¢æ–‡æ¡£"><a href="#æ–°å¢æ–‡æ¡£" class="headerlink" title="æ–°å¢æ–‡æ¡£"></a>æ–°å¢æ–‡æ¡£</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å•æ¡æ’å…¥ä¸å¤šæ¡æ’å…¥</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#1ã€æ²¡æœ‰æŒ‡å®š_idåˆ™é»˜è®¤ObjectId,_idä¸èƒ½é‡å¤ï¼Œä¸”åœ¨æ’å…¥åä¸å¯å˜</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#2ã€æ’å…¥å•æ¡</span></span><br><span class="line">user0=&#123;</span><br><span class="line">    <span class="string">&quot;name&quot;</span>:<span class="string">&quot;lucky&quot;</span>,</span><br><span class="line">    <span class="string">&quot;age&quot;</span>:10,</span><br><span class="line">    <span class="string">&#x27;hobbies&#x27;</span>:[<span class="string">&#x27;music&#x27;</span>,<span class="string">&#x27;read&#x27;</span>,<span class="string">&#x27;dancing&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;addr&#x27;</span>:&#123;</span><br><span class="line">        <span class="string">&#x27;country&#x27;</span>:<span class="string">&#x27;China&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;city&#x27;</span>:<span class="string">&#x27;BJ&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">db.test.insert(user0)</span><br><span class="line">db.test.find()</span><br><span class="line"></span><br><span class="line"><span class="comment">#3ã€æ’å…¥å¤šæ¡</span></span><br><span class="line">user1=&#123;</span><br><span class="line">    <span class="string">&quot;_id&quot;</span>:1,</span><br><span class="line">    <span class="string">&quot;name&quot;</span>:<span class="string">&quot;lucky1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;age&quot;</span>:10,</span><br><span class="line">    <span class="string">&#x27;hobbies&#x27;</span>:[<span class="string">&#x27;music&#x27;</span>,<span class="string">&#x27;read&#x27;</span>,<span class="string">&#x27;dancing&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;addr&#x27;</span>:&#123;</span><br><span class="line">        <span class="string">&#x27;country&#x27;</span>:<span class="string">&#x27;China&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;city&#x27;</span>:<span class="string">&#x27;weifang&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">user2=&#123;</span><br><span class="line">    <span class="string">&quot;_id&quot;</span>:2,</span><br><span class="line">    <span class="string">&quot;name&quot;</span>:<span class="string">&quot;lucky2&quot;</span>,</span><br><span class="line">    <span class="string">&quot;age&quot;</span>:20,</span><br><span class="line">    <span class="string">&#x27;hobbies&#x27;</span>:[<span class="string">&#x27;music&#x27;</span>,<span class="string">&#x27;read&#x27;</span>,<span class="string">&#x27;run&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;addr&#x27;</span>:&#123;</span><br><span class="line">        <span class="string">&#x27;country&#x27;</span>:<span class="string">&#x27;China&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;city&#x27;</span>:<span class="string">&#x27;hebei&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">db.user.insertMany([user1,user2])</span><br><span class="line"></span><br><span class="line"><span class="comment"># æœ‰åˆ™è¦†ç›–ï¼Œæ²¡åˆ™æ–°å¢</span></span><br><span class="line">db.user.save(&#123;<span class="string">&quot;_id&quot;</span>:1,<span class="string">&quot;name&quot;</span>:<span class="string">&quot;lucky&quot;</span>&#125;)</span><br><span class="line">db.user.save(&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;lucky&quot;</span>&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="æŸ¥è¯¢æ–‡æ¡£"><a href="#æŸ¥è¯¢æ–‡æ¡£" class="headerlink" title="æŸ¥è¯¢æ–‡æ¡£"></a>æŸ¥è¯¢æ–‡æ¡£</h4><p>æ¯”è¾ƒè¿ç®—</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ¯”è¾ƒè¿ç®—</span></span><br><span class="line"><span class="comment"># SQLï¼š=,!=,&gt;,&lt;,&gt;=,&lt;=</span></span><br><span class="line"><span class="comment"># MongoDBï¼š&#123;key:value&#125;ä»£è¡¨ä»€ä¹ˆç­‰äºä»€ä¹ˆ,&quot;$ne&quot;,&quot;$gt&quot;,&quot;$lt&quot;,&quot;gte&quot;,&quot;lte&quot;,å…¶ä¸­&quot;$ne&quot;èƒ½ç”¨äºæ‰€æœ‰æ•°æ®ç±»å‹</span></span><br><span class="line">db.user.find().pretty()  <span class="comment"># ä»¥jsonæ ¼å¼æ˜¾ç¤ºï¼Œäº†è§£</span></span><br><span class="line"><span class="comment">#1ã€select * from db1.user where name = &quot;lucky1&quot;;</span></span><br><span class="line">db.user.find(&#123;<span class="string">&#x27;name&#x27;</span>:<span class="string">&#x27;lucky1&#x27;</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">#2ã€select * from db1.user where name != &quot;lucky2&quot;;</span></span><br><span class="line">db.user.find(&#123;<span class="string">&#x27;name&#x27;</span>:&#123;<span class="string">&quot;<span class="variable">$ne</span>&quot;</span>:<span class="string">&#x27;lucky2&#x27;</span>&#125;&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">#3ã€select * from db1.user where id &gt; 2;</span></span><br><span class="line">db.user.find(&#123;<span class="string">&#x27;_id&#x27;</span>:&#123;<span class="string">&#x27;$gt&#x27;</span>:2&#125;&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">#4ã€select * from db1.user where id &lt; 3;</span></span><br><span class="line">db.user.find(&#123;<span class="string">&#x27;_id&#x27;</span>:&#123;<span class="string">&#x27;$lt&#x27;</span>:3&#125;&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">#5ã€select * from db1.user where id &gt;= 2;</span></span><br><span class="line">db.user.find(&#123;<span class="string">&quot;_id&quot;</span>:&#123;<span class="string">&quot;<span class="variable">$gte</span>&quot;</span>:2,&#125;&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">#6ã€select * from db1.user where id &lt;= 2;</span></span><br><span class="line">db.user.find(&#123;<span class="string">&quot;_id&quot;</span>:&#123;<span class="string">&quot;<span class="variable">$lte</span>&quot;</span>:2&#125;&#125;)</span><br></pre></td></tr></table></figure>

<p>é€»è¾‘è¿ç®—</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#é€»è¾‘è¿ç®—</span></span><br><span class="line"><span class="comment"># SQLï¼šandï¼Œorï¼Œnot ï¼Œmodï¼ˆå–ä½™æ•°ï¼‰</span></span><br><span class="line"><span class="comment"># MongoDBï¼šå­—å…¸ä¸­é€—å·åˆ†éš”çš„å¤šä¸ªæ¡ä»¶æ˜¯andå…³ç³»ï¼Œ&quot;$or&quot;çš„æ¡ä»¶æ”¾åˆ°[]å†…,&quot;$not&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#1ã€select * from db1.user where id &gt;= 2 and id &lt; 4;</span></span><br><span class="line">db.user.find(&#123;<span class="string">&#x27;_id&#x27;</span>:&#123;<span class="string">&quot;<span class="variable">$gte</span>&quot;</span>:2,<span class="string">&quot;<span class="variable">$lt</span>&quot;</span>:4&#125;&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">#2ã€select * from db1.user where id &gt;= 2 and age &lt; 40;</span></span><br><span class="line">db.user.find(&#123;<span class="string">&quot;_id&quot;</span>:&#123;<span class="string">&quot;<span class="variable">$gte</span>&quot;</span>:2&#125;,<span class="string">&quot;age&quot;</span>:&#123;<span class="string">&quot;<span class="variable">$lt</span>&quot;</span>:40&#125;&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">#3ã€select * from db1.user where id &gt;= 5 or name = &quot;lucky&quot;;</span></span><br><span class="line">db.user.find(&#123;</span><br><span class="line">    <span class="string">&quot;<span class="variable">$or</span>&quot;</span>:[</span><br><span class="line">        &#123;<span class="string">&#x27;_id&#x27;</span>:&#123;<span class="string">&quot;<span class="variable">$gte</span>&quot;</span>:5&#125;&#125;,</span><br><span class="line">        &#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;lucky&quot;</span>&#125;</span><br><span class="line">        ]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#4ã€select * from db1.user where id % 2=1;</span></span><br><span class="line">db.user.find(&#123;<span class="string">&#x27;_id&#x27;</span>:&#123;<span class="string">&quot;<span class="variable">$mod</span>&quot;</span>:[2,1]&#125;&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">#5ã€ä¸Šé¢˜ï¼Œå–å</span></span><br><span class="line">db.user.find(&#123;<span class="string">&#x27;_id&#x27;</span>:&#123;<span class="string">&quot;<span class="variable">$not</span>&quot;</span>:&#123;<span class="string">&quot;<span class="variable">$mod</span>&quot;</span>:[2,1]&#125;&#125;&#125;)</span><br></pre></td></tr></table></figure>

<p>æˆå‘˜è¿ç®—</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æˆå‘˜è¿ç®—</span></span><br><span class="line"><span class="comment"># SQLï¼šinï¼Œnot in</span></span><br><span class="line"><span class="comment"># MongoDBï¼š&quot;$in&quot;,&quot;$nin&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#1ã€select * from db1.user where age in (20,30,31);</span></span><br><span class="line">db.user.find(&#123;<span class="string">&quot;age&quot;</span>:&#123;<span class="string">&quot;<span class="variable">$in</span>&quot;</span>:[20,30,31]&#125;&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">#2ã€select * from db1.user where name not in (&#x27;lucky1&#x27;,&#x27;lucky2&#x27;);</span></span><br><span class="line">db.user.find(&#123;<span class="string">&quot;name&quot;</span>:&#123;<span class="string">&quot;<span class="variable">$nin</span>&quot;</span>:[<span class="string">&#x27;lucky1&#x27;</span>,<span class="string">&#x27;lucky2&#x27;</span>]&#125;&#125;)</span><br></pre></td></tr></table></figure>

<p>æ­£åˆ™åŒ¹é…</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># SQL: regexp æ­£åˆ™</span></span><br><span class="line"><span class="comment"># MongoDB: /æ­£åˆ™è¡¨è¾¾/i</span></span><br><span class="line"><span class="comment">#1ã€select * from db1.user where name regexp &#x27;^l&#x27;;</span></span><br><span class="line"><span class="comment"># æŸ¥è¯¢åå­—ä»¥lå¼€å¤´çš„äºº</span></span><br><span class="line">db.user.find(&#123;<span class="string">&quot;name&quot;</span>:/.*?/&#125;)</span><br><span class="line">db.user.find(&#123;<span class="string">&quot;name&quot;</span>:/^l/&#125;)</span><br><span class="line"><span class="comment"># æŸ¥è¯¢åå­—ä»¥lå¼€å¤´ï¼Œä»¥1ç»“å°¾çš„æ‰€æœ‰æ•°æ®</span></span><br><span class="line">db.user.find(&#123;<span class="string">&quot;name&quot;</span>:/^l.*?1$/&#125;)</span><br></pre></td></tr></table></figure>

<p>å–æŒ‡å®šå­—æ®µ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1ã€select name,age from db1.user where id=3;</span></span><br><span class="line">db.user.find(&#123;<span class="string">&#x27;_id&#x27;</span>:3&#125;,&#123;<span class="string">&#x27;_id&#x27;</span>:0,<span class="string">&#x27;name&#x27;</span>:1,<span class="string">&#x27;age&#x27;</span>:1&#125;)</span><br><span class="line"><span class="comment"># 0è¡¨ç¤ºä¸æ˜¾ç¤ºï¼Œ1è¡¨ç¤ºæ˜¾ç¤º</span></span><br></pre></td></tr></table></figure>

<p>æŸ¥è¯¢æ•°ç»„</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1ã€æŸ¥çœ‹æœ‰dancingçˆ±å¥½çš„äºº</span></span><br><span class="line">db.user.find(&#123;<span class="string">&#x27;hobbies&#x27;</span>:<span class="string">&#x27;dancing&#x27;</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">#2ã€æŸ¥çœ‹æ—¢æœ‰dancingçˆ±å¥½åˆæœ‰teaçˆ±å¥½çš„äºº</span></span><br><span class="line">db.user.find(&#123;</span><br><span class="line">    <span class="string">&#x27;hobbies&#x27;</span>:&#123;</span><br><span class="line">        <span class="string">&quot;<span class="variable">$all</span>&quot;</span>:[<span class="string">&#x27;dancing&#x27;</span>,<span class="string">&#x27;tea&#x27;</span>]</span><br><span class="line">        &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">#3ã€æŸ¥çœ‹ç¬¬4ä¸ªçˆ±å¥½ä¸ºteaçš„äºº</span></span><br><span class="line">db.user.find(&#123;<span class="string">&quot;hobbies.3&quot;</span>:<span class="string">&#x27;tea&#x27;</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">#4ã€æŸ¥çœ‹æ‰€æœ‰äººæœ€åä¸¤ä¸ªçˆ±å¥½(æ³¨æ„æ²¡æœ‰hobbieså­—æ®µçš„ä¹Ÿä¼šè¢«æŸ¥å‡º)ï¼ˆæœ¬è´¨ç”¨çš„æ˜¯å–æŒ‡å®šå­—æ®µï¼Œæ‰€ä»¥è¦æ”¾åœ¨åé¢çš„å­—å…¸ä¸­ï¼‰</span></span><br><span class="line">db.user.find(&#123;&#125;,&#123;<span class="string">&#x27;hobbies&#x27;</span>:&#123;<span class="string">&quot;<span class="variable">$slice</span>&quot;</span>:-2&#125;,<span class="string">&quot;age&quot;</span>:0,<span class="string">&quot;_id&quot;</span>:0,<span class="string">&quot;name&quot;</span>:0,<span class="string">&quot;addr&quot;</span>:0&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">#5ã€æŸ¥çœ‹æ‰€æœ‰äººçš„ç¬¬2ä¸ªåˆ°ç¬¬3ä¸ªçˆ±å¥½</span></span><br><span class="line">db.user.find(&#123;&#125;,&#123;<span class="string">&#x27;hobbies&#x27;</span>:&#123;<span class="string">&quot;<span class="variable">$slice</span>&quot;</span>:[1,2]&#125;,<span class="string">&quot;age&quot;</span>:0,<span class="string">&quot;_id&quot;</span>:0,<span class="string">&quot;name&quot;</span>:0,<span class="string">&quot;addr&quot;</span>:0&#125;)</span><br><span class="line"></span><br><span class="line">db.blog.find().pretty() <span class="comment">#ç¾åŒ–</span></span><br><span class="line"></span><br><span class="line">db.blog.find(&#123;&#125;,&#123;<span class="string">&#x27;comments&#x27;</span>:&#123;<span class="string">&quot;<span class="variable">$slice</span>&quot;</span>:-2&#125;&#125;).pretty() <span class="comment">#æŸ¥è¯¢æœ€åä¸¤ä¸ª</span></span><br><span class="line">db.blog.find(&#123;&#125;,&#123;<span class="string">&#x27;comments&#x27;</span>:&#123;<span class="string">&quot;<span class="variable">$slice</span>&quot;</span>:[1,2]&#125;&#125;).pretty() <span class="comment">#æŸ¥è¯¢1åˆ°2</span></span><br></pre></td></tr></table></figure>

<p>æ’åº</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ’åº:--1ä»£è¡¨å‡åºï¼Œ-1ä»£è¡¨é™åº</span></span><br><span class="line">db.user.find().<span class="built_in">sort</span>(&#123;<span class="string">&quot;name&quot;</span>:1,&#125;)</span><br><span class="line">db.user.find().<span class="built_in">sort</span>(&#123;<span class="string">&quot;age&quot;</span>:-1,<span class="string">&#x27;_id&#x27;</span>:1&#125;)</span><br></pre></td></tr></table></figure>

<p>åˆ†é¡µ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ†é¡µ:--limitä»£è¡¨å–å¤šå°‘ä¸ªdocumentï¼Œskipä»£è¡¨è·³è¿‡å‰å¤šå°‘ä¸ªdocumentã€‚ </span></span><br><span class="line"><span class="comment"># limitä¸­è¡¨ç¤ºä¸€é¡µæ˜¾ç¤ºçš„æ¡æ•°ï¼Œskip(é¡µç æ•°*ä¸€é¡µæ˜¾ç¤ºçš„æ¡æ•°)</span></span><br><span class="line">db.user.find().<span class="built_in">sort</span>(&#123;<span class="string">&#x27;age&#x27;</span>:1&#125;).<span class="built_in">limit</span>(1).skip(2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¡¨å…³è”</span></span><br><span class="line">user &#123;_id:1,name:lucky,age:18&#125;   ä¸€ä¸ªäººå†™å¤šç¯‡æ–‡ç« </span><br><span class="line">article ----ã€‹å­æŸ¥è¯¢</span><br><span class="line">	&#123;<span class="string">&#x27;userid&#x27;</span>:1,article:çº¢æ¥¼æ¢¦&#125;</span><br><span class="line">  &#123;<span class="string">&#x27;userid&#x27;</span>:1,article:è¥¿æ¸¸è®°&#125;</span><br></pre></td></tr></table></figure>

<p>è·å–æ•°é‡</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è·å–æ•°é‡</span></span><br><span class="line">db.user.count(&#123;<span class="string">&#x27;age&#x27;</span>:&#123;<span class="string">&quot;<span class="variable">$gt</span>&quot;</span>:30&#125;&#125;) </span><br><span class="line">--æˆ–è€…</span><br><span class="line">db.user.find(&#123;<span class="string">&#x27;age&#x27;</span>:&#123;<span class="string">&quot;<span class="variable">$gt</span>&quot;</span>:30&#125;&#125;).count()</span><br></pre></td></tr></table></figure>

<p>å…¶ä»–</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1ã€&#123;&#x27;key&#x27;:null&#125; åŒ¹é…keyçš„å€¼ä¸ºnullæˆ–è€…æ²¡æœ‰è¿™ä¸ªkey</span></span><br><span class="line">db.t2.insert(&#123;<span class="string">&#x27;a&#x27;</span>:10,<span class="string">&#x27;b&#x27;</span>:111&#125;)</span><br><span class="line">db.t2.insert(&#123;<span class="string">&#x27;a&#x27;</span>:20&#125;)</span><br><span class="line">db.t2.insert(&#123;<span class="string">&#x27;b&#x27;</span>:null&#125;)</span><br><span class="line"></span><br><span class="line">&gt; db.t2.find(&#123;<span class="string">&quot;b&quot;</span>:null&#125;)</span><br><span class="line">&#123; <span class="string">&quot;_id&quot;</span> : ObjectId(<span class="string">&quot;5a5cc2a7c1b4645aad959e5a&quot;</span>), <span class="string">&quot;a&quot;</span> : 20 &#125;</span><br><span class="line">&#123; <span class="string">&quot;_id&quot;</span> : ObjectId(<span class="string">&quot;5a5cc2a8c1b4645aad959e5b&quot;</span>), <span class="string">&quot;b&quot;</span> : null &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#2ã€æŸ¥æ‰¾æ‰€æœ‰</span></span><br><span class="line">db.user.find() <span class="comment">#ç­‰åŒäºdb.user.find(&#123;&#125;)</span></span><br><span class="line">db.user.find().pretty()</span><br><span class="line"></span><br><span class="line"><span class="comment">#3ã€æŸ¥æ‰¾ä¸€ä¸ªï¼Œä¸findç”¨æ³•ä¸€è‡´ï¼Œåªæ˜¯åªå–åŒ¹é…æˆåŠŸçš„ç¬¬ä¸€ä¸ª</span></span><br><span class="line">db.user.findOne(&#123;<span class="string">&quot;_id&quot;</span>:&#123;<span class="string">&quot;<span class="variable">$gt</span>&quot;</span>:3&#125;&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="ä¿®æ”¹æ–‡æ¡£"><a href="#ä¿®æ”¹æ–‡æ¡£" class="headerlink" title="ä¿®æ”¹æ–‡æ¡£"></a>ä¿®æ”¹æ–‡æ¡£</h4><p>è¯­æ³•ä»‹ç»</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">update() æ–¹æ³•ç”¨äºæ›´æ–°å·²å­˜åœ¨çš„æ–‡æ¡£ã€‚è¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š</span><br><span class="line">db.collection.update(</span><br><span class="line">   &lt;query&gt;,</span><br><span class="line">   &lt;update&gt;,</span><br><span class="line">   &#123;</span><br><span class="line">     upsert: &lt;boolean&gt;,</span><br><span class="line">     multi: &lt;boolean&gt;,</span><br><span class="line">     writeConcern: &lt;document&gt;</span><br><span class="line">   &#125;</span><br><span class="line">)</span><br><span class="line">å‚æ•°è¯´æ˜ï¼šå¯¹æ¯”update db1.t1 <span class="built_in">set</span> name=<span class="string">&#x27;lucky&#x27;</span>,sex=<span class="string">&#x27;Male&#x27;</span> <span class="built_in">where</span> name=<span class="string">&#x27;lucky1&#x27;</span> and age=18;</span><br><span class="line"></span><br><span class="line">db.collection.update(</span><br><span class="line">   &#123;name:&#123;<span class="variable">$ne</span>:lucky&#125;&#125;,</span><br><span class="line">   &#123;å­—å…¸&#125;,</span><br><span class="line">   &#123;</span><br><span class="line">     upsert: &lt;boolean&gt;,</span><br><span class="line">     multi: &lt;boolean&gt;,</span><br><span class="line">     writeConcern: &lt;document&gt;</span><br><span class="line">   &#125;</span><br><span class="line">)</span><br><span class="line">query : ç›¸å½“äº<span class="built_in">where</span>æ¡ä»¶ã€‚</span><br><span class="line">update : updateçš„å¯¹è±¡å’Œä¸€äº›æ›´æ–°çš„æ“ä½œç¬¦ï¼ˆå¦‚$,<span class="variable">$inc</span>...ç­‰ï¼Œç›¸å½“äº<span class="built_in">set</span>åé¢çš„</span><br><span class="line">upsert : å¯é€‰ï¼Œé»˜è®¤ä¸º<span class="literal">false</span>ï¼Œä»£è¡¨å¦‚æœä¸å­˜åœ¨updateçš„è®°å½•ä¸æ›´æ–°ä¹Ÿä¸æ’å…¥ï¼Œè®¾ç½®ä¸º<span class="literal">true</span>ä»£è¡¨æ’å…¥ã€‚</span><br><span class="line">multi : å¯é€‰ï¼Œé»˜è®¤ä¸º<span class="literal">false</span>ï¼Œä»£è¡¨åªæ›´æ–°æ‰¾åˆ°çš„ç¬¬ä¸€æ¡è®°å½•ï¼Œè®¾ä¸º<span class="literal">true</span>,ä»£è¡¨æ›´æ–°æ‰¾åˆ°çš„å…¨éƒ¨è®°å½•ã€‚</span><br><span class="line">writeConcern :å¯é€‰ï¼ŒæŠ›å‡ºå¼‚å¸¸çš„çº§åˆ«ã€‚</span><br><span class="line"></span><br><span class="line">æ›´æ–°æ“ä½œæ˜¯ä¸å¯åˆ†å‰²çš„ï¼šè‹¥ä¸¤ä¸ªæ›´æ–°åŒæ—¶å‘é€ï¼Œå…ˆåˆ°è¾¾æœåŠ¡å™¨çš„å…ˆæ‰§è¡Œï¼Œç„¶åæ‰§è¡Œå¦å¤–ä¸€ä¸ªï¼Œä¸ä¼šç ´åæ–‡æ¡£ã€‚</span><br></pre></td></tr></table></figure>

<p>è¦†ç›–å¼</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æ³¨æ„ï¼šé™¤éæ˜¯åˆ é™¤ï¼Œå¦åˆ™_idæ˜¯å§‹ç»ˆä¸ä¼šå˜çš„</span></span><br><span class="line"><span class="comment">#1ã€è¦†ç›–å¼:</span></span><br><span class="line">db.user.update(&#123;<span class="string">&#x27;age&#x27;</span>:30&#125;,&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;lucky9&quot;</span>,<span class="string">&quot;hobbies_count&quot;</span>:3&#125;)</span><br><span class="line">æ˜¯ç”¨&#123;<span class="string">&quot;_id&quot;</span>:3,<span class="string">&quot;name&quot;</span>:<span class="string">&quot;lucky3&quot;</span>,<span class="string">&quot;hobbies_count&quot;</span>:3&#125;è¦†ç›–åŸæ¥çš„è®°å½•</span><br><span class="line"></span><br><span class="line"><span class="comment">#2ã€ä¸€ç§æœ€ç®€å•çš„æ›´æ–°å°±æ˜¯ç”¨ä¸€ä¸ªæ–°çš„æ–‡æ¡£å®Œå…¨æ›¿æ¢åŒ¹é…çš„æ–‡æ¡£ã€‚è¿™é€‚ç”¨äºå¤§è§„æ¨¡å¼è¿ç§»çš„æƒ…å†µã€‚ä¾‹å¦‚</span></span><br><span class="line">var obj=db.user.findOne(&#123;<span class="string">&quot;_id&quot;</span>:4&#125;)</span><br><span class="line"></span><br><span class="line">obj.username=obj.name+<span class="string">&#x27;NB&#x27;</span></span><br><span class="line">obj.hobbies_count++</span><br><span class="line">delete obj.age</span><br><span class="line">delete obj._id</span><br><span class="line"></span><br><span class="line">db.user.update(&#123;<span class="string">&quot;_id&quot;</span>:2&#125;,obj)</span><br></pre></td></tr></table></figure>

<p>è®¾ç½®$set</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#è®¾ç½®ï¼š$set</span></span><br><span class="line"></span><br><span class="line">é€šå¸¸æ–‡æ¡£åªä¼šæœ‰ä¸€éƒ¨åˆ†éœ€è¦æ›´æ–°ã€‚å¯ä»¥ä½¿ç”¨åŸå­æ€§çš„æ›´æ–°ä¿®æ”¹å™¨ï¼ŒæŒ‡å®šå¯¹æ–‡æ¡£ä¸­çš„æŸäº›å­—æ®µè¿›è¡Œæ›´æ–°ã€‚</span><br><span class="line">æ›´æ–°ä¿®æ”¹å™¨æ˜¯ç§ç‰¹æ®Šçš„é”®ï¼Œç”¨æ¥æŒ‡å®šå¤æ‚çš„æ›´æ–°æ“ä½œï¼Œæ¯”å¦‚ä¿®æ”¹ã€å¢åŠ åè€…åˆ é™¤</span><br><span class="line"></span><br><span class="line"><span class="comment">#1ã€update db1.user set  name=&quot;å¼ ä¸‰&quot; where id = 2</span></span><br><span class="line">db.user.update(&#123;<span class="string">&#x27;_id&#x27;</span>:2&#125;,&#123;<span class="string">&quot;<span class="variable">$set</span>&quot;</span>:&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;å¼ ä¸‰&quot;</span>,&#125;&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">#2ã€æ²¡æœ‰åŒ¹é…æˆåŠŸåˆ™æ–°å¢ä¸€æ¡&#123;&quot;upsert&quot;:true&#125;</span></span><br><span class="line">db.user.update(&#123;<span class="string">&#x27;_id&#x27;</span>:6&#125;,&#123;<span class="string">&quot;<span class="variable">$set</span>&quot;</span>:&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;æé£åˆ€&quot;</span>,<span class="string">&quot;age&quot;</span>:18&#125;&#125;,&#123;<span class="string">&quot;upsert&quot;</span>:<span class="literal">true</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">#3ã€é»˜è®¤åªæ”¹åŒ¹é…æˆåŠŸçš„ç¬¬ä¸€æ¡,&#123;&quot;multi&quot;:æ”¹å¤šæ¡&#125;</span></span><br><span class="line">db.user.update(&#123;<span class="string">&#x27;_id&#x27;</span>:&#123;<span class="string">&quot;<span class="variable">$gt</span>&quot;</span>:4&#125;&#125;,&#123;<span class="string">&quot;<span class="variable">$set</span>&quot;</span>:&#123;<span class="string">&quot;age&quot;</span>:28&#125;&#125;)</span><br><span class="line">db.user.update(&#123;<span class="string">&#x27;_id&#x27;</span>:&#123;<span class="string">&quot;<span class="variable">$gte</span>&quot;</span>:4&#125;&#125;,&#123;<span class="string">&quot;<span class="variable">$set</span>&quot;</span>:&#123;<span class="string">&quot;age&quot;</span>:38&#125;&#125;,&#123;<span class="string">&quot;multi&quot;</span>:<span class="literal">true</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">#4ã€ä¿®æ”¹å†…åµŒæ–‡æ¡£ï¼ŒæŠŠåå­—ä¸ºlucky4çš„äººæ‰€åœ¨çš„åœ°å€å›½å®¶æ”¹æˆJapan</span></span><br><span class="line">db.user.update(&#123;<span class="string">&#x27;name&#x27;</span>:<span class="string">&quot;lucky4&quot;</span>&#125;,&#123;<span class="string">&quot;<span class="variable">$set</span>&quot;</span>:&#123;<span class="string">&quot;addr.country&quot;</span>:<span class="string">&quot;Japan&quot;</span>&#125;&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">#5ã€æŠŠåå­—ä¸ºlucky4çš„äººçš„ç¬¬2ä¸ªçˆ±å¥½æ”¹æˆsleep</span></span><br><span class="line">db.user.update(&#123;<span class="string">&#x27;name&#x27;</span>:<span class="string">&quot;lucky4&quot;</span>&#125;,&#123;<span class="string">&quot;<span class="variable">$set</span>&quot;</span>:&#123;<span class="string">&quot;hobbies.1&quot;</span>:<span class="string">&quot;sleep&quot;</span>&#125;&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">#6ã€åˆ é™¤lucky4çš„çˆ±å¥½,$unset</span></span><br><span class="line">db.user.update(&#123;<span class="string">&#x27;name&#x27;</span>:<span class="string">&quot;lucky4&quot;</span>&#125;,&#123;<span class="string">&quot;<span class="variable">$unset</span>&quot;</span>:&#123;<span class="string">&quot;hobbies&quot;</span>:<span class="string">&quot;&quot;</span>&#125;&#125;)</span><br></pre></td></tr></table></figure>

<p>å¢åŠ å’Œå‡å°‘</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å¢åŠ å’Œå‡å°‘ï¼š$inc</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#1ã€æ‰€æœ‰äººå¹´é¾„å¢åŠ ä¸€å²</span></span><br><span class="line">db.user.update(&#123;&#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">&quot;<span class="variable">$inc</span>&quot;</span>:&#123;<span class="string">&quot;age&quot;</span>:1&#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">&quot;multi&quot;</span>:<span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">    )</span><br><span class="line"><span class="comment">#2ã€æ‰€æœ‰äººå¹´é¾„å‡å°‘5å²</span></span><br><span class="line">db.user.update(&#123;&#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">&quot;<span class="variable">$inc</span>&quot;</span>:&#123;<span class="string">&quot;age&quot;</span>:-5&#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">&quot;multi&quot;</span>:<span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">    )</span><br></pre></td></tr></table></figure>

<p>æ·»åŠ åˆ é™¤ç»„å†…å…ƒç´ <code> $push $pop $pull</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æ·»åŠ åˆ é™¤æ•°ç»„å†…å…ƒç´ </span></span><br><span class="line">    </span><br><span class="line">å¾€æ•°ç»„å†…æ·»åŠ å…ƒç´ :<span class="variable">$push</span></span><br><span class="line"><span class="comment">#1ã€ä¸ºåå­—ä¸ºluckyçš„äººæ·»åŠ ä¸€ä¸ªçˆ±å¥½read</span></span><br><span class="line">db.user.update(&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;lucky&quot;</span>&#125;,&#123;<span class="string">&quot;<span class="variable">$push</span>&quot;</span>:&#123;<span class="string">&quot;hobbies&quot;</span>:<span class="string">&quot;read&quot;</span>&#125;&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">#2ã€ä¸ºåå­—ä¸ºluckyçš„äººä¸€æ¬¡æ·»åŠ å¤šä¸ªçˆ±å¥½teaï¼Œdancing</span></span><br><span class="line">db.user.update(&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;lucky&quot;</span>&#125;,&#123;<span class="string">&quot;<span class="variable">$push</span>&quot;</span>:&#123;</span><br><span class="line">    <span class="string">&quot;hobbies&quot;</span>:&#123;<span class="string">&quot;<span class="variable">$each</span>&quot;</span>:[<span class="string">&quot;tea&quot;</span>,<span class="string">&quot;dancing&quot;</span>]&#125;</span><br><span class="line">&#125;&#125;)</span><br><span class="line"></span><br><span class="line">æŒ‰ç…§ä½ç½®ä¸”åªèƒ½ä»å¼€å¤´æˆ–ç»“å°¾åˆ é™¤å…ƒç´ ï¼š<span class="variable">$pop</span></span><br><span class="line"><span class="comment">#3ã€&#123;&quot;$pop&quot;:&#123;&quot;key&quot;:1&#125;&#125; ä»æ•°ç»„æœ«å°¾åˆ é™¤ä¸€ä¸ªå…ƒç´ </span></span><br><span class="line"></span><br><span class="line">db.user.update(&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;lucky&quot;</span>&#125;,&#123;<span class="string">&quot;<span class="variable">$pop</span>&quot;</span>:&#123;</span><br><span class="line">    <span class="string">&quot;hobbies&quot;</span>:1&#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">#4ã€&#123;&quot;$pop&quot;:&#123;&quot;key&quot;:-1&#125;&#125; ä»å¤´éƒ¨åˆ é™¤</span></span><br><span class="line">db.user.update(&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;lucky&quot;</span>&#125;,&#123;<span class="string">&quot;<span class="variable">$pop</span>&quot;</span>:&#123;</span><br><span class="line">    <span class="string">&quot;hobbies&quot;</span>:-1&#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">#5ã€æŒ‰ç…§æ¡ä»¶åˆ é™¤å…ƒç´ ,ï¼š&quot;$pull&quot; æŠŠç¬¦åˆæ¡ä»¶çš„ç»Ÿç»Ÿåˆ æ‰ï¼Œè€Œ$popåªèƒ½ä»ä¸¤ç«¯åˆ </span></span><br><span class="line"><span class="comment"># åˆ é™¤æ‰€æœ‰å›½å®¶ä¸ºchineçš„äººçš„readçˆ±å¥½</span></span><br><span class="line">db.user.update(&#123;<span class="string">&#x27;addr.country&#x27;</span>:<span class="string">&quot;China&quot;</span>&#125;,&#123;<span class="string">&quot;<span class="variable">$pull</span>&quot;</span>:&#123;</span><br><span class="line">    <span class="string">&quot;hobbies&quot;</span>:<span class="string">&quot;read&quot;</span>&#125;</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;multi&quot;</span>:<span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>é¿å…é‡å¤ â€œ$addToSetâ€</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#é¿å…æ·»åŠ é‡å¤ï¼š&quot;$addToSet&quot;</span></span><br><span class="line"></span><br><span class="line">db.urls.insert(&#123;<span class="string">&quot;_id&quot;</span>:1,<span class="string">&quot;urls&quot;</span>:[]&#125;)</span><br><span class="line"></span><br><span class="line">db.urls.update(&#123;<span class="string">&quot;_id&quot;</span>:1&#125;,&#123;<span class="string">&quot;<span class="variable">$addToSet</span>&quot;</span>:&#123;<span class="string">&quot;urls&quot;</span>:<span class="string">&#x27;http://www.baidu.com&#x27;</span>&#125;&#125;)</span><br><span class="line">db.urls.update(&#123;<span class="string">&quot;_id&quot;</span>:1&#125;,&#123;<span class="string">&quot;<span class="variable">$addToSet</span>&quot;</span>:&#123;<span class="string">&quot;urls&quot;</span>:<span class="string">&#x27;http://www.baidu.com&#x27;</span>&#125;&#125;)</span><br><span class="line">db.urls.update(&#123;<span class="string">&quot;_id&quot;</span>:1&#125;,&#123;<span class="string">&quot;<span class="variable">$addToSet</span>&quot;</span>:&#123;<span class="string">&quot;urls&quot;</span>:<span class="string">&#x27;http://www.baidu.com&#x27;</span>&#125;&#125;)</span><br><span class="line"></span><br><span class="line">db.urls.update(&#123;<span class="string">&quot;_id&quot;</span>:1&#125;,&#123;</span><br><span class="line">    <span class="string">&quot;<span class="variable">$addToSet</span>&quot;</span>:&#123;</span><br><span class="line">        <span class="string">&quot;urls&quot;</span>:&#123;</span><br><span class="line">        <span class="string">&quot;<span class="variable">$each</span>&quot;</span>:[</span><br><span class="line">            <span class="string">&#x27;http://www.baidu.com&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;http://www.baidu.com&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;http://www.xxxx.com&#x27;</span></span><br><span class="line">            ]</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>å…¶ä»–</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1ã€äº†è§£ï¼šé™åˆ¶å¤§å°&quot;$slice&quot;ï¼Œåªç•™æœ€ånä¸ª</span></span><br><span class="line"></span><br><span class="line">db.user.update(&#123;<span class="string">&quot;_id&quot;</span>:5&#125;,&#123;</span><br><span class="line">    <span class="string">&quot;<span class="variable">$push</span>&quot;</span>:&#123;<span class="string">&quot;hobbies&quot;</span>:&#123;</span><br><span class="line">        <span class="string">&quot;<span class="variable">$each</span>&quot;</span>:[<span class="string">&quot;read&quot;</span>,<span class="string">&#x27;music&#x27;</span>,<span class="string">&#x27;dancing&#x27;</span>],</span><br><span class="line">        <span class="string">&quot;<span class="variable">$slice</span>&quot;</span>:-2</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">#2ã€äº†è§£ï¼šæ’åºThe $sort element value must be either 1 or -1&quot;</span></span><br><span class="line">db.user.update(&#123;<span class="string">&quot;_id&quot;</span>:5&#125;,&#123;</span><br><span class="line">    <span class="string">&quot;<span class="variable">$push</span>&quot;</span>:&#123;<span class="string">&quot;hobbies&quot;</span>:&#123;</span><br><span class="line">        <span class="string">&quot;<span class="variable">$each</span>&quot;</span>:[<span class="string">&quot;read&quot;</span>,<span class="string">&#x27;music&#x27;</span>,<span class="string">&#x27;dancing&#x27;</span>],</span><br><span class="line">        <span class="string">&quot;<span class="variable">$slice</span>&quot;</span>:-1,</span><br><span class="line">        <span class="string">&quot;<span class="variable">$sort</span>&quot;</span>:-1</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">#æ³¨æ„ï¼šä¸èƒ½åªå°†&quot;$slice&quot;æˆ–è€…&quot;$sort&quot;ä¸&quot;$push&quot;é…åˆä½¿ç”¨ï¼Œä¸”å¿…é¡»ä½¿ç”¨&quot;$each&quot;</span></span><br></pre></td></tr></table></figure>

<h4 id="åˆ é™¤æ–‡æ¡£"><a href="#åˆ é™¤æ–‡æ¡£" class="headerlink" title="åˆ é™¤æ–‡æ¡£"></a>åˆ é™¤æ–‡æ¡£</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1ã€åˆ é™¤å¤šä¸ªä¸­çš„ç¬¬ä¸€ä¸ª</span></span><br><span class="line">db.user.deleteOne(&#123; <span class="string">&#x27;age&#x27;</span>: 8 &#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">#2ã€åˆ é™¤å›½å®¶ä¸ºChinaçš„å…¨éƒ¨</span></span><br><span class="line">db.user.deleteMany( &#123;<span class="string">&#x27;addr.country&#x27;</span>: <span class="string">&#x27;China&#x27;</span>&#125; ) </span><br><span class="line"></span><br><span class="line"><span class="comment">#3ã€åˆ é™¤å…¨éƒ¨</span></span><br><span class="line">db.user.deleteMany(&#123;&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="èšåˆ"><a href="#èšåˆ" class="headerlink" title="èšåˆ"></a>èšåˆ</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">å¦‚æœæ•°æ®å­˜å‚¨åœ¨MongoDBä¸­ï¼Œæƒ³åšçš„å¯èƒ½å°±ä¸ä»…ä»…æ˜¯å°†æ•°æ®æå–å‡ºæ¥é‚£ä¹ˆç®€å•äº†ï¼›å¯èƒ½å¸Œæœ›å¯¹æ•°æ®è¿›è¡Œåˆ†æå¹¶åŠ ä»¥åˆ©ç”¨ã€‚MongoDBæä¾›äº†ä»¥ä¸‹èšåˆå·¥å…·ï¼š</span><br><span class="line"><span class="comment">#1ã€èšåˆæ¡†æ¶</span></span><br><span class="line"><span class="comment">#2ã€MapReduce(è¯¦è§MongoDBæƒå¨æŒ‡å—)</span></span><br><span class="line"><span class="comment">#3ã€å‡ ä¸ªç®€å•èšåˆå‘½ä»¤ï¼šcountã€distinctå’Œgroupã€‚(è¯¦è§MongoDBæƒå¨æŒ‡å—)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#èšåˆæ¡†æ¶ï¼š</span></span><br><span class="line">å¯ä»¥ä½¿ç”¨å¤šä¸ªæ„ä»¶åˆ›å»ºä¸€ä¸ªç®¡é“ï¼Œä¸Šä¸€ä¸ªæ„ä»¶çš„ç»“æœä¼ ç»™ä¸‹ä¸€ä¸ªæ„ä»¶ã€‚</span><br><span class="line">è¿™äº›æ„ä»¶åŒ…æ‹¬ï¼ˆæ‹¬å·å†…ä¸ºæ„ä»¶å¯¹åº”çš„æ“ä½œç¬¦ï¼‰ï¼šç­›é€‰(<span class="variable">$match</span>)ã€æŠ•å°„(<span class="variable">$project</span>)ã€åˆ†ç»„(<span class="variable">$group</span>)ã€æ’åº(<span class="variable">$sort</span>)ã€é™åˆ¶(<span class="variable">$limit</span>)ã€è·³è¿‡(<span class="variable">$skip</span>)</span><br><span class="line">ä¸åŒçš„ç®¡é“æ“ä½œç¬¦å¯ä»¥ä»»æ„ç»„åˆï¼Œé‡å¤ä½¿ç”¨</span><br></pre></td></tr></table></figure>

<p>å‡†å¤‡æ•°æ®</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">from pymongo import MongoClient</span><br><span class="line">import datetime</span><br><span class="line"></span><br><span class="line">client=MongoClient(<span class="string">&#x27;mongodb://root:123@localhost:27017&#x27;</span>)</span><br><span class="line">table=client[<span class="string">&#x27;db1&#x27;</span>][<span class="string">&#x27;emp&#x27;</span>]</span><br><span class="line"><span class="comment"># table.drop()</span></span><br><span class="line"></span><br><span class="line">l=[</span><br><span class="line">(<span class="string">&#x27;æˆé¾™&#x27;</span>,<span class="string">&#x27;male&#x27;</span>,48,<span class="string">&#x27;20101111&#x27;</span>,<span class="string">&#x27;teacher&#x27;</span>,10000,401,1),</span><br><span class="line"></span><br><span class="line">(<span class="string">&#x27;æ­ªæ­ª&#x27;</span>,<span class="string">&#x27;female&#x27;</span>,48,<span class="string">&#x27;20150311&#x27;</span>,<span class="string">&#x27;sale&#x27;</span>,3000.13,402,2),<span class="comment">#ä»¥ä¸‹æ˜¯é”€å”®éƒ¨é—¨</span></span><br><span class="line">(<span class="string">&#x27;ä¸«ä¸«&#x27;</span>,<span class="string">&#x27;female&#x27;</span>,38,<span class="string">&#x27;20101101&#x27;</span>,<span class="string">&#x27;sale&#x27;</span>,2000.35,402,2),</span><br><span class="line">(<span class="string">&#x27;ä¸ä¸&#x27;</span>,<span class="string">&#x27;female&#x27;</span>,18,<span class="string">&#x27;20110312&#x27;</span>,<span class="string">&#x27;sale&#x27;</span>,1000.37,402,2),</span><br><span class="line">(<span class="string">&#x27;æ˜Ÿæ˜Ÿ&#x27;</span>,<span class="string">&#x27;female&#x27;</span>,18,<span class="string">&#x27;20160513&#x27;</span>,<span class="string">&#x27;sale&#x27;</span>,3000.29,402,2),</span><br><span class="line">(<span class="string">&#x27;æ ¼æ ¼&#x27;</span>,<span class="string">&#x27;female&#x27;</span>,28,<span class="string">&#x27;20170127&#x27;</span>,<span class="string">&#x27;sale&#x27;</span>,4000.33,402,2),</span><br><span class="line"></span><br><span class="line">(<span class="string">&#x27;å¼ é‡&#x27;</span>,<span class="string">&#x27;male&#x27;</span>,28,<span class="string">&#x27;20160311&#x27;</span>,<span class="string">&#x27;operation&#x27;</span>,10000.13,403,3), <span class="comment">#ä»¥ä¸‹æ˜¯è¿è¥éƒ¨é—¨</span></span><br><span class="line">(<span class="string">&#x27;ç¨‹å’¬é‡‘&#x27;</span>,<span class="string">&#x27;male&#x27;</span>,18,<span class="string">&#x27;19970312&#x27;</span>,<span class="string">&#x27;operation&#x27;</span>,20000,403,3),</span><br><span class="line">(<span class="string">&#x27;ç¨‹å’¬é“¶&#x27;</span>,<span class="string">&#x27;female&#x27;</span>,18,<span class="string">&#x27;20130311&#x27;</span>,<span class="string">&#x27;operation&#x27;</span>,19000,403,3),</span><br><span class="line">(<span class="string">&#x27;ç¨‹å’¬é“œ&#x27;</span>,<span class="string">&#x27;male&#x27;</span>,18,<span class="string">&#x27;20150411&#x27;</span>,<span class="string">&#x27;operation&#x27;</span>,18000,403,3),</span><br><span class="line">(<span class="string">&#x27;ç¨‹å’¬é“&#x27;</span>,<span class="string">&#x27;female&#x27;</span>,18,<span class="string">&#x27;20140512&#x27;</span>,<span class="string">&#x27;operation&#x27;</span>,17000,403,3)</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> n,item <span class="keyword">in</span> enumerate(l):</span><br><span class="line">    d=&#123;</span><br><span class="line">        <span class="string">&quot;_id&quot;</span>:n,</span><br><span class="line">        <span class="string">&#x27;name&#x27;</span>:item[0],</span><br><span class="line">        <span class="string">&#x27;sex&#x27;</span>:item[1],</span><br><span class="line">        <span class="string">&#x27;age&#x27;</span>:item[2],</span><br><span class="line">        <span class="string">&#x27;hire_date&#x27;</span>:datetime.datetime.strptime(item[3],<span class="string">&#x27;%Y%m%d&#x27;</span>),</span><br><span class="line">        <span class="string">&#x27;post&#x27;</span>:item[4],</span><br><span class="line">        <span class="string">&#x27;salary&#x27;</span>:item[5]</span><br><span class="line">    &#125;</span><br><span class="line">    table.save(d)</span><br></pre></td></tr></table></figure>

<p>ç­›é€‰ â€œ$matchâ€</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">&quot;<span class="variable">$match</span>&quot;</span>:&#123;<span class="string">&quot;å­—æ®µ&quot;</span>:<span class="string">&quot;æ¡ä»¶&quot;</span>&#125;&#125;,å¯ä»¥ä½¿ç”¨ä»»ä½•å¸¸ç”¨æŸ¥è¯¢æ“ä½œç¬¦<span class="variable">$gt</span>,<span class="variable">$lt</span>,<span class="variable">$in</span>ç­‰</span><br><span class="line"></span><br><span class="line"><span class="comment">#ä¾‹1ã€select * from db1.emp where post=&#x27;teacher&#x27;;</span></span><br><span class="line">db.emp.aggregate(&#123;<span class="string">&quot;<span class="variable">$match</span>&quot;</span>:&#123;<span class="string">&quot;post&quot;</span>:<span class="string">&quot;teacher&quot;</span>&#125;&#125;) <span class="comment"># shellç‰ˆæœ¬ä¸åŒ¹é…ï¼Œä¼šå‡ºé”™</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ä¾‹2ã€select * from db1.emp where id &gt; 3 group by post;  </span></span><br><span class="line"><span class="comment"># è®¡ç®—æ¯ä¸ªéƒ¨é—¨çš„å¹³å‡å·¥èµ„</span></span><br><span class="line">select post as _id,avg(salary) as avg_salary from db1.emp <span class="built_in">where</span> <span class="built_in">id</span> &gt; 3 group by post;  </span><br><span class="line">db.emp.aggregate(</span><br><span class="line">    &#123;<span class="string">&quot;<span class="variable">$match</span>&quot;</span>:&#123;<span class="string">&quot;_id&quot;</span>:&#123;<span class="string">&quot;<span class="variable">$gt</span>&quot;</span>:3&#125;&#125;&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;<span class="variable">$group</span>&quot;</span>:&#123;<span class="string">&quot;_id&quot;</span>:<span class="string">&quot;<span class="variable">$post</span>&quot;</span>,<span class="string">&#x27;avg_salary&#x27;</span>:&#123;<span class="string">&quot;<span class="variable">$avg</span>&quot;</span>:<span class="string">&quot;<span class="variable">$salary</span>&quot;</span>&#125;&#125;&#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">#ä¾‹3ã€select post as _id,avg(salary) as avg_salary from db.emp where id &gt; 3 group by post having avg(avg_salary) &gt; 10000; </span></span><br><span class="line"><span class="comment"># æŸ¥è¯¢å¹³å‡å·¥èµ„å¤§äº10000çš„éƒ¨é—¨</span></span><br><span class="line">db.emp.aggregate(</span><br><span class="line">    &#123;<span class="string">&quot;<span class="variable">$match</span>&quot;</span>:&#123;<span class="string">&quot;_id&quot;</span>:&#123;<span class="string">&quot;<span class="variable">$gt</span>&quot;</span>:3&#125;&#125;&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;<span class="variable">$group</span>&quot;</span>:&#123;<span class="string">&quot;_id&quot;</span>:<span class="string">&quot;<span class="variable">$post</span>&quot;</span>,<span class="string">&#x27;avg_salary&#x27;</span>:&#123;<span class="string">&quot;<span class="variable">$avg</span>&quot;</span>:<span class="string">&quot;<span class="variable">$salary</span>&quot;</span>&#125;&#125;&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;<span class="variable">$match</span>&quot;</span>:&#123;<span class="string">&quot;avg_salary&quot;</span>:&#123;<span class="string">&quot;<span class="variable">$gt</span>&quot;</span>:10000&#125;&#125;&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>æŠ•å°„ $project</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">&quot;<span class="variable">$project</span>&quot;</span>:&#123;<span class="string">&quot;è¦ä¿ç•™çš„å­—æ®µå&quot;</span>:1,<span class="string">&quot;è¦å»æ‰çš„å­—æ®µå&quot;</span>:0,<span class="string">&quot;æ–°å¢çš„å­—æ®µå&quot;</span>:<span class="string">&quot;è¡¨è¾¾å¼&quot;</span>&#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#1ã€select name,post,(age+1) as new_age from db1.emp;</span></span><br><span class="line">db.emp.aggregate(</span><br><span class="line">    &#123;<span class="string">&quot;<span class="variable">$project</span>&quot;</span>:&#123;</span><br><span class="line">        <span class="string">&quot;name&quot;</span>:1,</span><br><span class="line">        <span class="string">&quot;post&quot;</span>:1,</span><br><span class="line">        <span class="string">&quot;new_age&quot;</span>:&#123;<span class="string">&quot;<span class="variable">$add</span>&quot;</span>:[<span class="string">&quot;<span class="variable">$age</span>&quot;</span>,1]&#125;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">#2ã€è¡¨è¾¾å¼ä¹‹æ•°å­¦è¡¨è¾¾å¼</span></span><br><span class="line">&#123;<span class="string">&quot;<span class="variable">$add</span>&quot;</span>:[expr1,expr2,...,exprN]&#125; <span class="comment">#ç›¸åŠ </span></span><br><span class="line">&#123;<span class="string">&quot;<span class="variable">$subtract</span>&quot;</span>:[expr1,expr2]&#125; <span class="comment">#ç¬¬ä¸€ä¸ªå‡ç¬¬äºŒä¸ª</span></span><br><span class="line">&#123;<span class="string">&quot;<span class="variable">$multiply</span>&quot;</span>:[expr1,expr2,...,exprN]&#125; <span class="comment">#ç›¸ä¹˜</span></span><br><span class="line">&#123;<span class="string">&quot;<span class="variable">$divide</span>&quot;</span>:[expr1,expr2]&#125; <span class="comment">#ç¬¬ä¸€ä¸ªè¡¨è¾¾å¼é™¤ä»¥ç¬¬äºŒä¸ªè¡¨è¾¾å¼çš„å•†ä½œä¸ºç»“æœ</span></span><br><span class="line">&#123;<span class="string">&quot;<span class="variable">$mod</span>&quot;</span>:[expr1,expr2]&#125; <span class="comment">#ç¬¬ä¸€ä¸ªè¡¨è¾¾å¼é™¤ä»¥ç¬¬äºŒä¸ªè¡¨è¾¾å¼å¾—åˆ°çš„ä½™æ•°ä½œä¸ºç»“æœ</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#3ã€è¡¨è¾¾å¼ä¹‹æ—¥æœŸè¡¨è¾¾å¼:$year,$month,$week,$dayOfMonth,$dayOfWeek,$dayOfYear,$hour,$minute,$second</span></span><br><span class="line"><span class="comment">#ä¾‹å¦‚ï¼šselect name,date_format(&quot;%Y&quot;) as hire_year from db1.emp</span></span><br><span class="line">db.emp.aggregate(</span><br><span class="line">    &#123;<span class="string">&quot;<span class="variable">$project</span>&quot;</span>:&#123;<span class="string">&quot;name&quot;</span>:1,<span class="string">&quot;hire_year&quot;</span>:&#123;<span class="string">&quot;<span class="variable">$year</span>&quot;</span>:<span class="string">&quot;<span class="variable">$hire_date</span>&quot;</span>&#125;&#125;&#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">#ä¾‹å¦‚æŸ¥çœ‹æ¯ä¸ªå‘˜å·¥çš„å·¥ä½œå¤šé•¿æ—¶é—´</span></span><br><span class="line">db.emp.aggregate(</span><br><span class="line">    &#123;<span class="string">&quot;<span class="variable">$project</span>&quot;</span>:&#123;<span class="string">&quot;name&quot;</span>:1,<span class="string">&quot;hire_period&quot;</span>:&#123;</span><br><span class="line">        <span class="string">&quot;<span class="variable">$subtract</span>&quot;</span>:[</span><br><span class="line">            &#123;<span class="string">&quot;<span class="variable">$year</span>&quot;</span>:new Date()&#125;,</span><br><span class="line">            &#123;<span class="string">&quot;<span class="variable">$year</span>&quot;</span>:<span class="string">&quot;<span class="variable">$hire_date</span>&quot;</span>&#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;&#125;&#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#4ã€å­—ç¬¦ä¸²è¡¨è¾¾å¼</span></span><br><span class="line">&#123;<span class="string">&quot;<span class="variable">$substr</span>&quot;</span>:[å­—ç¬¦ä¸²/$å€¼ä¸ºå­—ç¬¦ä¸²çš„å­—æ®µå,èµ·å§‹ä½ç½®,æˆªå–å‡ ä¸ªå­—èŠ‚]&#125;</span><br><span class="line">&#123;<span class="string">&quot;<span class="variable">$concat</span>&quot;</span>:[expr1,expr2,...,exprN]&#125; <span class="comment">#æŒ‡å®šçš„è¡¨è¾¾å¼æˆ–å­—ç¬¦ä¸²è¿æ¥åœ¨ä¸€èµ·è¿”å›,åªæ”¯æŒå­—ç¬¦ä¸²æ‹¼æ¥</span></span><br><span class="line">&#123;<span class="string">&quot;<span class="variable">$toLower</span>&quot;</span>:<span class="built_in">expr</span>&#125;</span><br><span class="line">&#123;<span class="string">&quot;<span class="variable">$toUpper</span>&quot;</span>:<span class="built_in">expr</span>&#125;</span><br><span class="line"></span><br><span class="line">db.emp.aggregate( &#123;<span class="string">&quot;<span class="variable">$project</span>&quot;</span>:&#123;<span class="string">&quot;NAME&quot;</span>:&#123;<span class="string">&quot;<span class="variable">$toUpper</span>&quot;</span>:<span class="string">&quot;<span class="variable">$name</span>&quot;</span>&#125;&#125;&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># é™¤ä¸«ä¸«å¤–ï¼Œæ‰€æœ‰äººåå­—åŠ SB</span></span><br><span class="line"></span><br><span class="line">db.emp.aggregate(</span><br><span class="line">    &#123;<span class="string">&quot;<span class="variable">$match</span>&quot;</span>:&#123;<span class="string">&quot;name&quot;</span>:&#123;<span class="string">&quot;<span class="variable">$ne</span>&quot;</span>:<span class="string">&quot;ä¸«ä¸«&quot;</span>&#125;&#125;&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;<span class="variable">$project</span>&quot;</span>:</span><br><span class="line">        &#123;<span class="string">&quot;_id&quot;</span>:0,<span class="string">&quot;new_name&quot;</span>:</span><br><span class="line">            &#123;<span class="string">&quot;<span class="variable">$concat</span>&quot;</span>:</span><br><span class="line">                [<span class="string">&quot;<span class="variable">$name</span>&quot;</span>,<span class="string">&quot;SB&quot;</span>]</span><br><span class="line">                &#125;  </span><br><span class="line">            &#125;&#125;            </span><br><span class="line">)</span><br><span class="line"><span class="comment"># å–é™¤luckyå¤–ï¼Œ æ‰€æœ‰äººåå­—3ä¸ªå­—èŠ‚ï¼ˆutf8ç¼–ç ï¼Œ3ä¸ªå­—èŠ‚ä¸€ä¸ªæ±‰å­—ï¼‰</span></span><br><span class="line">db.emp.aggregate(</span><br><span class="line">    &#123;<span class="string">&quot;<span class="variable">$match</span>&quot;</span>:&#123;<span class="string">&quot;name&quot;</span>:&#123;<span class="string">&quot;<span class="variable">$ne</span>&quot;</span>:<span class="string">&quot;lucky&quot;</span>&#125;&#125;&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;<span class="variable">$project</span>&quot;</span>:</span><br><span class="line">        &#123;<span class="string">&quot;_id&quot;</span>:0,<span class="string">&quot;new_name&quot;</span>:</span><br><span class="line">            &#123;<span class="string">&quot;<span class="variable">$substr</span>&quot;</span>:</span><br><span class="line">                [<span class="string">&quot;<span class="variable">$name</span>&quot;</span>,0,3]</span><br><span class="line">                &#125;  </span><br><span class="line">            &#125;&#125;            </span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>åˆ†ç»„ $group</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">&quot;<span class="variable">$group</span>&quot;</span>:&#123;<span class="string">&quot;_id&quot;</span>:åˆ†ç»„å­—æ®µ,<span class="string">&quot;æ–°çš„å­—æ®µå&quot;</span>:èšåˆæ“ä½œç¬¦&#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#1ã€å°†åˆ†ç»„å­—æ®µä¼ ç»™$groupå‡½æ•°çš„_idå­—æ®µå³å¯</span></span><br><span class="line">&#123;<span class="string">&quot;<span class="variable">$group</span>&quot;</span>:&#123;<span class="string">&quot;_id&quot;</span>:<span class="string">&quot;<span class="variable">$sex</span>&quot;</span>&#125;&#125; <span class="comment">#æŒ‰ç…§æ€§åˆ«åˆ†ç»„</span></span><br><span class="line">&#123;<span class="string">&quot;<span class="variable">$group</span>&quot;</span>:&#123;<span class="string">&quot;_id&quot;</span>:<span class="string">&quot;<span class="variable">$post</span>&quot;</span>&#125;&#125; <span class="comment">#æŒ‰ç…§èŒä½åˆ†ç»„</span></span><br><span class="line">&#123;<span class="string">&quot;<span class="variable">$group</span>&quot;</span>:&#123;<span class="string">&quot;_id&quot;</span>:&#123;<span class="string">&quot;state&quot;</span>:<span class="string">&quot;<span class="variable">$state</span>&quot;</span>,<span class="string">&quot;city&quot;</span>:<span class="string">&quot;<span class="variable">$city</span>&quot;</span>&#125;&#125;&#125; <span class="comment">#æŒ‰ç…§å¤šä¸ªå­—æ®µåˆ†ç»„ï¼Œæ¯”å¦‚æŒ‰ç…§å·å¸‚åˆ†ç»„</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#2ã€åˆ†ç»„åèšåˆå¾—ç»“æœ,ç±»ä¼¼äºsqlä¸­èšåˆå‡½æ•°çš„èšåˆæ“ä½œç¬¦ï¼š$sumã€$avgã€$maxã€$minã€$firstã€$last</span></span><br><span class="line"><span class="comment">#ä¾‹1ï¼šselect post,max(salary) as max_salary from db1.emp group by post; </span></span><br><span class="line">db.emp.aggregate(&#123;<span class="string">&quot;<span class="variable">$group</span>&quot;</span>:&#123;<span class="string">&quot;_id&quot;</span>:<span class="string">&quot;<span class="variable">$post</span>&quot;</span>,<span class="string">&quot;max_salary&quot;</span>:&#123;<span class="string">&quot;<span class="variable">$max</span>&quot;</span>:<span class="string">&quot;<span class="variable">$salary</span>&quot;</span>&#125;&#125;&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">#ä¾‹2ï¼šå»æ¯ä¸ªéƒ¨é—¨æœ€å¤§è–ªèµ„ä¸æœ€ä½è–ªèµ„</span></span><br><span class="line">db.emp.aggregate(&#123;<span class="string">&quot;<span class="variable">$group</span>&quot;</span>:&#123;<span class="string">&quot;_id&quot;</span>:<span class="string">&quot;<span class="variable">$post</span>&quot;</span>,<span class="string">&quot;max_salary&quot;</span>:&#123;<span class="string">&quot;<span class="variable">$max</span>&quot;</span>:<span class="string">&quot;<span class="variable">$salary</span>&quot;</span>&#125;,<span class="string">&quot;min_salary&quot;</span>:&#123;<span class="string">&quot;<span class="variable">$min</span>&quot;</span>:<span class="string">&quot;<span class="variable">$salary</span>&quot;</span>&#125;&#125;&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">#ä¾‹3ï¼šå¦‚æœå­—æ®µæ˜¯æ’åºåçš„ï¼Œé‚£ä¹ˆ$first,$lastä¼šå¾ˆæœ‰ç”¨,æ¯”ç”¨$maxå’Œ$minæ•ˆç‡é«˜</span></span><br><span class="line">db.emp.aggregate(&#123;<span class="string">&quot;<span class="variable">$group</span>&quot;</span>:&#123;<span class="string">&quot;_id&quot;</span>:<span class="string">&quot;<span class="variable">$post</span>&quot;</span>,<span class="string">&quot;first_id&quot;</span>:&#123;<span class="string">&quot;<span class="variable">$first</span>&quot;</span>:<span class="string">&quot;<span class="variable">$_id</span>&quot;</span>&#125;&#125;&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">#ä¾‹4ï¼šæ±‚æ¯ä¸ªéƒ¨é—¨çš„æ€»å·¥èµ„</span></span><br><span class="line">db.emp.aggregate(&#123;<span class="string">&quot;<span class="variable">$group</span>&quot;</span>:&#123;<span class="string">&quot;_id&quot;</span>:<span class="string">&quot;<span class="variable">$post</span>&quot;</span>,<span class="string">&quot;count&quot;</span>:&#123;<span class="string">&quot;<span class="variable">$sum</span>&quot;</span>:<span class="string">&quot;<span class="variable">$salary</span>&quot;</span>&#125;&#125;&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">#ä¾‹5ï¼šæ±‚æ¯ä¸ªéƒ¨é—¨çš„äººæ•°</span></span><br><span class="line">seledt count(1) as count from emp;</span><br><span class="line">db.emp.aggregate(&#123;<span class="string">&quot;<span class="variable">$group</span>&quot;</span>:&#123;<span class="string">&quot;_id&quot;</span>:<span class="string">&quot;<span class="variable">$post</span>&quot;</span>,<span class="string">&quot;count&quot;</span>:&#123;<span class="string">&quot;<span class="variable">$sum</span>&quot;</span>:1&#125;&#125;&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">#3ã€æ•°ç»„æ“ä½œç¬¦</span></span><br><span class="line">&#123;<span class="string">&quot;<span class="variable">$addToSet</span>&quot;</span>:<span class="built_in">expr</span>&#125;ï¼šä¸é‡å¤</span><br><span class="line">&#123;<span class="string">&quot;<span class="variable">$push</span>&quot;</span>:<span class="built_in">expr</span>&#125;ï¼šé‡å¤</span><br><span class="line"></span><br><span class="line"><span class="comment">#ä¾‹ï¼šæŸ¥è¯¢å²—ä½åä»¥åŠå„å²—ä½å†…çš„å‘˜å·¥å§“å:select post,group_concat(name) from db1.emp group by post;</span></span><br><span class="line">db.emp.aggregate(&#123;<span class="string">&quot;<span class="variable">$group</span>&quot;</span>:&#123;<span class="string">&quot;_id&quot;</span>:<span class="string">&quot;<span class="variable">$post</span>&quot;</span>,<span class="string">&quot;names&quot;</span>:&#123;<span class="string">&quot;<span class="variable">$push</span>&quot;</span>:<span class="string">&quot;<span class="variable">$name</span>&quot;</span>&#125;&#125;&#125;)</span><br><span class="line"><span class="comment"># è·Ÿä¸Šé¢ä¸€æ ·</span></span><br><span class="line">db.emp.aggregate(&#123;<span class="string">&quot;<span class="variable">$group</span>&quot;</span>:&#123;<span class="string">&quot;_id&quot;</span>:<span class="string">&quot;<span class="variable">$post</span>&quot;</span>,<span class="string">&quot;names&quot;</span>:&#123;<span class="string">&quot;<span class="variable">$addToSet</span>&quot;</span>:<span class="string">&quot;<span class="variable">$name</span>&quot;</span>&#125;&#125;&#125;)</span><br></pre></td></tr></table></figure>

<p>æ’åº$sort é™åˆ¶ $limit è·³è¿‡ $skip</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">&quot;<span class="variable">$sort</span>&quot;</span>:&#123;<span class="string">&quot;å­—æ®µå&quot;</span>:1,<span class="string">&quot;å­—æ®µå&quot;</span>:-1&#125;&#125; <span class="comment">#1å‡åºï¼Œ-1é™åº</span></span><br><span class="line">&#123;<span class="string">&quot;<span class="variable">$limit</span>&quot;</span>:n&#125; </span><br><span class="line">&#123;<span class="string">&quot;<span class="variable">$skip</span>&quot;</span>:n&#125; <span class="comment">#è·³è¿‡å¤šå°‘ä¸ªæ–‡æ¡£</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ä¾‹1ã€å–å¹³å‡å·¥èµ„æœ€é«˜çš„å‰ä¸¤ä¸ªéƒ¨é—¨</span></span><br><span class="line">db.emp.aggregate(</span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;<span class="variable">$group</span>&quot;</span>:&#123;<span class="string">&quot;_id&quot;</span>:<span class="string">&quot;<span class="variable">$post</span>&quot;</span>,<span class="string">&quot;å¹³å‡å·¥èµ„&quot;</span>:&#123;<span class="string">&quot;<span class="variable">$avg</span>&quot;</span>:<span class="string">&quot;<span class="variable">$salary</span>&quot;</span>&#125;&#125;</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;<span class="variable">$sort</span>&quot;</span>:&#123;<span class="string">&quot;å¹³å‡å·¥èµ„&quot;</span>:-1&#125;</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;<span class="variable">$limit</span>&quot;</span>:2</span><br><span class="line">&#125;</span><br><span class="line">)</span><br><span class="line"><span class="comment">#ä¾‹2ã€</span></span><br><span class="line">db.emp.aggregate(</span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;<span class="variable">$group</span>&quot;</span>:&#123;<span class="string">&quot;_id&quot;</span>:<span class="string">&quot;<span class="variable">$post</span>&quot;</span>,<span class="string">&quot;å¹³å‡å·¥èµ„&quot;</span>:&#123;<span class="string">&quot;<span class="variable">$avg</span>&quot;</span>:<span class="string">&quot;<span class="variable">$salary</span>&quot;</span>&#125;&#125;</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;<span class="variable">$sort</span>&quot;</span>:&#123;<span class="string">&quot;å¹³å‡å·¥èµ„&quot;</span>:-1&#125;</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;<span class="variable">$limit</span>&quot;</span>:3</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;<span class="variable">$skip</span>&quot;</span>:1</span><br><span class="line">&#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">db.emp.aggregate(</span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;<span class="variable">$group</span>&quot;</span>:&#123;<span class="string">&quot;_id&quot;</span>:<span class="string">&quot;<span class="variable">$post</span>&quot;</span>,<span class="string">&quot;å¹³å‡å·¥èµ„&quot;</span>:&#123;<span class="string">&quot;<span class="variable">$avg</span>&quot;</span>:<span class="string">&quot;<span class="variable">$salary</span>&quot;</span>&#125;&#125;</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;<span class="variable">$sort</span>&quot;</span>:&#123;<span class="string">&quot;å¹³å‡å·¥èµ„&quot;</span>:-1&#125;</span><br><span class="line">&#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="string">&quot;<span class="variable">$skip</span>&quot;</span>:2</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;<span class="variable">$limit</span>&quot;</span>:2</span><br><span class="line">&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>éšæœºé€‰å– $sample</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#é›†åˆusersåŒ…å«çš„æ–‡æ¡£å¦‚ä¸‹</span></span><br><span class="line">db.users.insertMany([</span><br><span class="line">&#123; <span class="string">&quot;_id&quot;</span> : 1, <span class="string">&quot;name&quot;</span> : <span class="string">&quot;dave123&quot;</span>, <span class="string">&quot;q1&quot;</span> : <span class="literal">true</span>, <span class="string">&quot;q2&quot;</span> : <span class="literal">true</span> &#125;,</span><br><span class="line">&#123; <span class="string">&quot;_id&quot;</span> : 2, <span class="string">&quot;name&quot;</span> : <span class="string">&quot;dave2&quot;</span>, <span class="string">&quot;q1&quot;</span> : <span class="literal">false</span>, <span class="string">&quot;q2&quot;</span> : <span class="literal">false</span>  &#125;,</span><br><span class="line">&#123; <span class="string">&quot;_id&quot;</span> : 3, <span class="string">&quot;name&quot;</span> : <span class="string">&quot;ahn&quot;</span>, <span class="string">&quot;q1&quot;</span> : <span class="literal">true</span>, <span class="string">&quot;q2&quot;</span> : <span class="literal">true</span>  &#125;,</span><br><span class="line">&#123; <span class="string">&quot;_id&quot;</span> : 4, <span class="string">&quot;name&quot;</span> : <span class="string">&quot;li&quot;</span>, <span class="string">&quot;q1&quot;</span> : <span class="literal">true</span>, <span class="string">&quot;q2&quot;</span> : <span class="literal">false</span>  &#125;,</span><br><span class="line">&#123; <span class="string">&quot;_id&quot;</span> : 5, <span class="string">&quot;name&quot;</span> : <span class="string">&quot;annT&quot;</span>, <span class="string">&quot;q1&quot;</span> : <span class="literal">false</span>, <span class="string">&quot;q2&quot;</span> : <span class="literal">true</span>  &#125;,</span><br><span class="line">&#123; <span class="string">&quot;_id&quot;</span> : 6, <span class="string">&quot;name&quot;</span> : <span class="string">&quot;li&quot;</span>, <span class="string">&quot;q1&quot;</span> : <span class="literal">true</span>, <span class="string">&quot;q2&quot;</span> : <span class="literal">true</span>  &#125;,</span><br><span class="line">&#123; <span class="string">&quot;_id&quot;</span> : 7, <span class="string">&quot;name&quot;</span> : <span class="string">&quot;ty&quot;</span>, <span class="string">&quot;q1&quot;</span> : <span class="literal">false</span>, <span class="string">&quot;q2&quot;</span> : <span class="literal">true</span>  &#125;</span><br><span class="line"></span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="comment">#ä¸‹è¿°æ“ä½œæ—¶ä»usersé›†åˆä¸­éšæœºé€‰å–3ä¸ªæ–‡æ¡£</span></span><br><span class="line"><span class="comment"># æŠ½å¥–</span></span><br><span class="line">db.users.aggregate(</span><br><span class="line">   [ &#123; <span class="variable">$sample</span>: &#123; size: 1 &#125; &#125; ]</span><br><span class="line">)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Pymongo"><a href="#Pymongo" class="headerlink" title="Pymongo"></a>Pymongo</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#https://api.mongodb.com/python/current/tutorial.html</span></span><br><span class="line"></span><br><span class="line">from pymongo import MongoClient</span><br><span class="line"></span><br><span class="line"><span class="comment">#1ã€é“¾æ¥</span></span><br><span class="line">client=MongoClient(<span class="string">&#x27;mongodb://root:123@localhost:27017/&#x27;</span>)</span><br><span class="line"><span class="comment"># client = MongoClient(&#x27;localhost&#x27;, 27017)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#2ã€use æ•°æ®åº“</span></span><br><span class="line">db=client[<span class="string">&#x27;db2&#x27;</span>] <span class="comment">#ç­‰åŒäºï¼šclient.db1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#3ã€æŸ¥çœ‹åº“ä¸‹æ‰€æœ‰çš„é›†åˆ</span></span><br><span class="line"><span class="built_in">print</span>(db.collection_names(include_system_collections=False))</span><br><span class="line"></span><br><span class="line"><span class="comment">#4ã€åˆ›å»ºé›†åˆ</span></span><br><span class="line">table_user=db[<span class="string">&#x27;userinfo&#x27;</span>] <span class="comment">#ç­‰åŒäºï¼šdb.user</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#5ã€æ’å…¥æ–‡æ¡£</span></span><br><span class="line">import datetime</span><br><span class="line">user0=&#123;</span><br><span class="line">    <span class="string">&quot;_id&quot;</span>:1,</span><br><span class="line">    <span class="string">&quot;name&quot;</span>:<span class="string">&quot;ä¸«ä¸«&quot;</span>,</span><br><span class="line">    <span class="string">&quot;birth&quot;</span>:datetime.datetime.now(),</span><br><span class="line">    <span class="string">&quot;age&quot;</span>:10,</span><br><span class="line">    <span class="string">&#x27;hobbies&#x27;</span>:[<span class="string">&#x27;music&#x27;</span>,<span class="string">&#x27;read&#x27;</span>,<span class="string">&#x27;dancing&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;addr&#x27;</span>:&#123;</span><br><span class="line">        <span class="string">&#x27;country&#x27;</span>:<span class="string">&#x27;China&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;city&#x27;</span>:<span class="string">&#x27;BJ&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">user1=&#123;</span><br><span class="line">    <span class="string">&quot;_id&quot;</span>:2,</span><br><span class="line">    <span class="string">&quot;name&quot;</span>:<span class="string">&quot;lucky&quot;</span>,</span><br><span class="line">    <span class="string">&quot;birth&quot;</span>:datetime.datetime.now(),</span><br><span class="line">    <span class="string">&quot;age&quot;</span>:10,</span><br><span class="line">    <span class="string">&#x27;hobbies&#x27;</span>:[<span class="string">&#x27;music&#x27;</span>,<span class="string">&#x27;read&#x27;</span>,<span class="string">&#x27;dancing&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;addr&#x27;</span>:&#123;</span><br><span class="line">        <span class="string">&#x27;country&#x27;</span>:<span class="string">&#x27;China&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;city&#x27;</span>:<span class="string">&#x27;weifang&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># res=table_user.insert_many([user0,user1]).inserted_ids</span></span><br><span class="line"><span class="comment"># print(res)</span></span><br><span class="line"><span class="comment"># print(table_user.count())</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#6ã€æŸ¥æ‰¾</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># from pprint import pprint#æ ¼å¼åŒ–ç»†</span></span><br><span class="line"><span class="comment"># pprint(table_user.find_one())</span></span><br><span class="line"><span class="comment"># for item in table_user.find():</span></span><br><span class="line"><span class="comment">#     pprint(item)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># print(table_user.find_one(&#123;&quot;_id&quot;:&#123;&quot;$gte&quot;:1&#125;,&quot;name&quot;:&#x27;lucky&#x27;&#125;))</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#7ã€æ›´æ–°</span></span><br><span class="line">table_user.update(&#123;<span class="string">&#x27;_id&#x27;</span>:1&#125;,&#123;<span class="string">&#x27;name&#x27;</span>:<span class="string">&#x27;lucky&#x27;</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">#8ã€ä¼ å…¥æ–°çš„æ–‡æ¡£æ›¿æ¢æ—§çš„æ–‡æ¡£</span></span><br><span class="line">table_user.save(</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">&quot;_id&quot;</span>:2,</span><br><span class="line">        <span class="string">&quot;name&quot;</span>:<span class="string">&#x27;ä¸«ä¸«_xxx&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># pip3 install pymong</span></span><br><span class="line">from pymongo import MongoClient</span><br><span class="line">from pymongo.collection import Collection</span><br><span class="line"><span class="comment">#MongoClient(&#x27;mongodb://root:123@localhost:27017/&#x27;)</span></span><br><span class="line">conn=MongoClient(host=<span class="string">&quot;10.0.0.5&quot;</span>,port=27017)</span><br><span class="line"></span><br><span class="line"><span class="comment"># use db</span></span><br><span class="line"><span class="comment"># pythonä¸­çš„é­”æ³•æ–¹æ³•(init,new,str) __add__</span></span><br><span class="line"><span class="comment"># with  __enter__  __exit__</span></span><br><span class="line"></span><br><span class="line">db=conn.db  <span class="comment"># é‡å†™äº†__getattr__</span></span><br><span class="line"><span class="comment"># db=conn[&quot;db&quot;] # é‡å†™äº†__getitem__</span></span><br><span class="line"><span class="comment">#db.users è·å–è¡¨</span></span><br><span class="line"><span class="built_in">users</span>=db.users <span class="comment"># type:Collection</span></span><br><span class="line"><span class="comment"># users.find(&#123;&#x27;name&#x27;:&quot;li&quot;&#125;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># users.insert_many()</span></span><br><span class="line"><span class="comment"># users.insert_one()</span></span><br><span class="line"><span class="comment"># updateè¢«å¼ƒç”¨äº†</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># users.update()</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># users.aggregate(&#123;&#125;,&#123;&#125;,&#123;&#125;)</span></span><br><span class="line"><span class="comment"># users.delete_many()</span></span><br><span class="line"><span class="comment"># users.delete_one()</span></span><br><span class="line"><span class="comment"># print(users.find())</span></span><br><span class="line"><span class="comment"># for i in users.find(&#123;&#x27;name&#x27;:&quot;li&quot;&#125;):</span></span><br><span class="line"><span class="comment">#     print(type(i))</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="ç»ƒä¹ é¢˜"><a href="#ç»ƒä¹ é¢˜" class="headerlink" title="ç»ƒä¹ é¢˜"></a>ç»ƒä¹ é¢˜</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">1. æŸ¥è¯¢å²—ä½åä»¥åŠå„å²—ä½å†…çš„å‘˜å·¥å§“å</span><br><span class="line">2. æŸ¥è¯¢å²—ä½åä»¥åŠå„å²—ä½å†…åŒ…å«çš„å‘˜å·¥ä¸ªæ•°</span><br><span class="line">3. æŸ¥è¯¢å…¬å¸å†…ç”·å‘˜å·¥å’Œå¥³å‘˜å·¥çš„ä¸ªæ•°</span><br><span class="line">4. æŸ¥è¯¢å²—ä½åä»¥åŠå„å²—ä½çš„å¹³å‡è–ªèµ„ã€æœ€é«˜è–ªèµ„ã€æœ€ä½è–ªèµ„</span><br><span class="line">5. æŸ¥è¯¢ç”·å‘˜å·¥ä¸ç”·å‘˜å·¥çš„å¹³å‡è–ªèµ„ï¼Œå¥³å‘˜å·¥ä¸å¥³å‘˜å·¥çš„å¹³å‡è–ªèµ„</span><br><span class="line">6. æŸ¥è¯¢å„å²—ä½å†…åŒ…å«çš„å‘˜å·¥ä¸ªæ•°å°äº2çš„å²—ä½åã€å²—ä½å†…åŒ…å«å‘˜å·¥åå­—ã€ä¸ªæ•°</span><br><span class="line">7. æŸ¥è¯¢å„å²—ä½å¹³å‡è–ªèµ„å¤§äº10000çš„å²—ä½åã€å¹³å‡å·¥èµ„</span><br><span class="line">8. æŸ¥è¯¢å„å²—ä½å¹³å‡è–ªèµ„å¤§äº10000ä¸”å°äº20000çš„å²—ä½åã€å¹³å‡å·¥èµ„</span><br><span class="line">9. æŸ¥è¯¢æ‰€æœ‰å‘˜å·¥ä¿¡æ¯ï¼Œå…ˆæŒ‰ç…§ageå‡åºæ’åºï¼Œå¦‚æœageç›¸åŒåˆ™æŒ‰ç…§hire_dateé™åºæ’åº</span><br><span class="line">10. æŸ¥è¯¢å„å²—ä½å¹³å‡è–ªèµ„å¤§äº10000çš„å²—ä½åã€å¹³å‡å·¥èµ„,ç»“æœæŒ‰å¹³å‡è–ªèµ„å‡åºæ’åˆ—</span><br><span class="line">11. æŸ¥è¯¢å„å²—ä½å¹³å‡è–ªèµ„å¤§äº10000çš„å²—ä½åã€å¹³å‡å·¥èµ„,ç»“æœæŒ‰å¹³å‡è–ªèµ„é™åºæ’åˆ—,å–å‰1ä¸ª</span><br><span class="line">1. æŸ¥è¯¢å²—ä½åä»¥åŠå„å²—ä½å†…çš„å‘˜å·¥å§“å</span><br><span class="line">db.emp.aggregate(&#123;<span class="string">&quot;<span class="variable">$group</span>&quot;</span>:&#123;<span class="string">&quot;_id&quot;</span>:<span class="string">&quot;<span class="variable">$post</span>&quot;</span>,<span class="string">&quot;names&quot;</span>:&#123;<span class="string">&quot;<span class="variable">$push</span>&quot;</span>:<span class="string">&quot;<span class="variable">$name</span>&quot;</span>&#125;&#125;&#125;)</span><br><span class="line"></span><br><span class="line">2. æŸ¥è¯¢å²—ä½åä»¥åŠå„å²—ä½å†…åŒ…å«çš„å‘˜å·¥ä¸ªæ•°</span><br><span class="line">db.emp.aggregate(&#123;<span class="string">&quot;<span class="variable">$group</span>&quot;</span>:&#123;<span class="string">&quot;_id&quot;</span>:<span class="string">&quot;<span class="variable">$post</span>&quot;</span>,<span class="string">&quot;count&quot;</span>:&#123;<span class="string">&quot;<span class="variable">$sum</span>&quot;</span>:1&#125;&#125;&#125;)</span><br><span class="line"></span><br><span class="line">3. æŸ¥è¯¢å…¬å¸å†…ç”·å‘˜å·¥å’Œå¥³å‘˜å·¥çš„ä¸ªæ•°</span><br><span class="line">db.emp.aggregate(&#123;<span class="string">&quot;<span class="variable">$group</span>&quot;</span>:&#123;<span class="string">&quot;_id&quot;</span>:<span class="string">&quot;<span class="variable">$sex</span>&quot;</span>,<span class="string">&quot;count&quot;</span>:&#123;<span class="string">&quot;<span class="variable">$sum</span>&quot;</span>:1&#125;&#125;&#125;)</span><br><span class="line"></span><br><span class="line">4. æŸ¥è¯¢å²—ä½åä»¥åŠå„å²—ä½çš„å¹³å‡è–ªèµ„ã€æœ€é«˜è–ªèµ„ã€æœ€ä½è–ªèµ„</span><br><span class="line">db.emp.aggregate(&#123;<span class="string">&quot;<span class="variable">$group</span>&quot;</span>:&#123;<span class="string">&quot;_id&quot;</span>:<span class="string">&quot;<span class="variable">$post</span>&quot;</span>,<span class="string">&quot;avg_salary&quot;</span>:&#123;<span class="string">&quot;<span class="variable">$avg</span>&quot;</span>:<span class="string">&quot;<span class="variable">$salary</span>&quot;</span>&#125;,<span class="string">&quot;max_salary&quot;</span>:&#123;<span class="string">&quot;<span class="variable">$max</span>&quot;</span>:<span class="string">&quot;<span class="variable">$salary</span>&quot;</span>&#125;,<span class="string">&quot;min_salary&quot;</span>:&#123;<span class="string">&quot;<span class="variable">$min</span>&quot;</span>:<span class="string">&quot;<span class="variable">$salary</span>&quot;</span>&#125;&#125;&#125;)</span><br><span class="line"></span><br><span class="line">5. æŸ¥è¯¢ç”·å‘˜å·¥ä¸ç”·å‘˜å·¥çš„å¹³å‡è–ªèµ„ï¼Œå¥³å‘˜å·¥ä¸å¥³å‘˜å·¥çš„å¹³å‡è–ªèµ„</span><br><span class="line">db.emp.aggregate(&#123;<span class="string">&quot;<span class="variable">$group</span>&quot;</span>:&#123;<span class="string">&quot;_id&quot;</span>:<span class="string">&quot;<span class="variable">$sex</span>&quot;</span>,<span class="string">&quot;avg_salary&quot;</span>:&#123;<span class="string">&quot;<span class="variable">$avg</span>&quot;</span>:<span class="string">&quot;<span class="variable">$salary</span>&quot;</span>&#125;&#125;&#125;)</span><br><span class="line"></span><br><span class="line">6. æŸ¥è¯¢å„å²—ä½å†…åŒ…å«çš„å‘˜å·¥ä¸ªæ•°å°äº2çš„å²—ä½åã€å²—ä½å†…åŒ…å«å‘˜å·¥åå­—ã€ä¸ªæ•°</span><br><span class="line">db.emp.aggregate(</span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;<span class="variable">$group</span>&quot;</span>:&#123;<span class="string">&quot;_id&quot;</span>:<span class="string">&quot;<span class="variable">$post</span>&quot;</span>,<span class="string">&quot;count&quot;</span>:&#123;<span class="string">&quot;<span class="variable">$sum</span>&quot;</span>:1&#125;,<span class="string">&quot;names&quot;</span>:&#123;<span class="string">&quot;<span class="variable">$push</span>&quot;</span>:<span class="string">&quot;<span class="variable">$name</span>&quot;</span>&#125;&#125;</span><br><span class="line">&#125;,</span><br><span class="line">&#123;<span class="string">&quot;<span class="variable">$match</span>&quot;</span>:&#123;<span class="string">&quot;count&quot;</span>:&#123;<span class="string">&quot;<span class="variable">$lt</span>&quot;</span>:2&#125;&#125;&#125;,</span><br><span class="line">&#123;<span class="string">&quot;<span class="variable">$project</span>&quot;</span>:&#123;<span class="string">&quot;_id&quot;</span>:0,<span class="string">&quot;names&quot;</span>:1,<span class="string">&quot;count&quot;</span>:1&#125;&#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">7. æŸ¥è¯¢å„å²—ä½å¹³å‡è–ªèµ„å¤§äº10000çš„å²—ä½åã€å¹³å‡å·¥èµ„</span><br><span class="line">db.emp.aggregate(</span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;<span class="variable">$group</span>&quot;</span>:&#123;<span class="string">&quot;_id&quot;</span>:<span class="string">&quot;<span class="variable">$post</span>&quot;</span>,<span class="string">&quot;avg_salary&quot;</span>:&#123;<span class="string">&quot;<span class="variable">$avg</span>&quot;</span>:<span class="string">&quot;<span class="variable">$salary</span>&quot;</span>&#125;&#125;</span><br><span class="line">&#125;,</span><br><span class="line">&#123;<span class="string">&quot;<span class="variable">$match</span>&quot;</span>:&#123;<span class="string">&quot;avg_salary&quot;</span>:&#123;<span class="string">&quot;<span class="variable">$gt</span>&quot;</span>:10000&#125;&#125;&#125;,</span><br><span class="line">&#123;<span class="string">&quot;<span class="variable">$project</span>&quot;</span>:&#123;<span class="string">&quot;_id&quot;</span>:1,<span class="string">&quot;avg_salary&quot;</span>:1&#125;&#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">8. æŸ¥è¯¢å„å²—ä½å¹³å‡è–ªèµ„å¤§äº10000ä¸”å°äº20000çš„å²—ä½åã€å¹³å‡å·¥èµ„</span><br><span class="line">db.emp.aggregate(</span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;<span class="variable">$group</span>&quot;</span>:&#123;<span class="string">&quot;_id&quot;</span>:<span class="string">&quot;<span class="variable">$post</span>&quot;</span>,<span class="string">&quot;avg_salary&quot;</span>:&#123;<span class="string">&quot;<span class="variable">$avg</span>&quot;</span>:<span class="string">&quot;<span class="variable">$salary</span>&quot;</span>&#125;&#125;</span><br><span class="line">&#125;,</span><br><span class="line">&#123;<span class="string">&quot;<span class="variable">$match</span>&quot;</span>:&#123;<span class="string">&quot;avg_salary&quot;</span>:&#123;<span class="string">&quot;<span class="variable">$gt</span>&quot;</span>:10000,<span class="string">&quot;<span class="variable">$lt</span>&quot;</span>:20000&#125;&#125;&#125;,</span><br><span class="line">&#123;<span class="string">&quot;<span class="variable">$project</span>&quot;</span>:&#123;<span class="string">&quot;_id&quot;</span>:1,<span class="string">&quot;avg_salary&quot;</span>:1&#125;&#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">9. æŸ¥è¯¢æ‰€æœ‰å‘˜å·¥ä¿¡æ¯ï¼Œå…ˆæŒ‰ç…§ageå‡åºæ’åºï¼Œå¦‚æœageç›¸åŒåˆ™æŒ‰ç…§hire_dateé™åºæ’åº</span><br><span class="line">db.emp.aggregate(</span><br><span class="line">&#123;<span class="string">&quot;<span class="variable">$sort</span>&quot;</span>:&#123;<span class="string">&quot;age&quot;</span>:1,<span class="string">&quot;hire_date&quot;</span>:-1&#125;&#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">10. æŸ¥è¯¢å„å²—ä½å¹³å‡è–ªèµ„å¤§äº10000çš„å²—ä½åã€å¹³å‡å·¥èµ„,ç»“æœæŒ‰å¹³å‡è–ªèµ„å‡åºæ’åˆ—</span><br><span class="line">db.emp.aggregate(</span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;<span class="variable">$group</span>&quot;</span>:&#123;<span class="string">&quot;_id&quot;</span>:<span class="string">&quot;<span class="variable">$post</span>&quot;</span>,<span class="string">&quot;avg_salary&quot;</span>:&#123;<span class="string">&quot;<span class="variable">$avg</span>&quot;</span>:<span class="string">&quot;<span class="variable">$salary</span>&quot;</span>&#125;&#125;</span><br><span class="line">&#125;,</span><br><span class="line">&#123;<span class="string">&quot;<span class="variable">$match</span>&quot;</span>:&#123;<span class="string">&quot;avg_salary&quot;</span>:&#123;<span class="string">&quot;<span class="variable">$gt</span>&quot;</span>:10000&#125;&#125;&#125;,</span><br><span class="line">&#123;<span class="string">&quot;<span class="variable">$sort</span>&quot;</span>:&#123;<span class="string">&quot;avg_salary&quot;</span>:1&#125;&#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">11. æŸ¥è¯¢å„å²—ä½å¹³å‡è–ªèµ„å¤§äº10000çš„å²—ä½åã€å¹³å‡å·¥èµ„,ç»“æœæŒ‰å¹³å‡è–ªèµ„é™åºæ’åˆ—,å–å‰1ä¸ª</span><br><span class="line">db.emp.aggregate(</span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;<span class="variable">$group</span>&quot;</span>:&#123;<span class="string">&quot;_id&quot;</span>:<span class="string">&quot;<span class="variable">$post</span>&quot;</span>,<span class="string">&quot;avg_salary&quot;</span>:&#123;<span class="string">&quot;<span class="variable">$avg</span>&quot;</span>:<span class="string">&quot;<span class="variable">$salary</span>&quot;</span>&#125;&#125;</span><br><span class="line">&#125;,</span><br><span class="line">&#123;<span class="string">&quot;<span class="variable">$match</span>&quot;</span>:&#123;<span class="string">&quot;avg_salary&quot;</span>:&#123;<span class="string">&quot;<span class="variable">$gt</span>&quot;</span>:10000&#125;&#125;&#125;,</span><br><span class="line">&#123;<span class="string">&quot;<span class="variable">$sort</span>&quot;</span>:&#123;<span class="string">&quot;avg_salary&quot;</span>:-1&#125;&#125;,</span><br><span class="line">&#123;<span class="string">&quot;<span class="variable">$limit</span>&quot;</span>:1&#125;,</span><br><span class="line">&#123;<span class="string">&quot;<span class="variable">$project</span>&quot;</span>:&#123;<span class="string">&quot;date&quot;</span>:new Date,<span class="string">&quot;å¹³å‡å·¥èµ„&quot;</span>:<span class="string">&quot;<span class="variable">$avg_salary</span>&quot;</span>,<span class="string">&quot;_id&quot;</span>:0&#125;&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

</div></section><div id="reward-container"><span class="hty-icon-button button-glow" id="reward-button" title="Donate" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === &quot;none&quot;) ? &quot;block&quot; : &quot;none&quot;;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-hand-coin-line"></use></svg></span><div id="reward-comment">æˆ‘å¾ˆå¯çˆ±ï¼Œè¯·ç»™æˆ‘é’±</div><div id="qr" style="display:none;"><div style="display:inline-block"></div><div style="display:inline-block"></div><div style="display:inline-block"></div></div></div><ul class="post-copyright"><li class="post-copyright-author"><strong>Post author: </strong>å°æ—</li><li class="post-copyright-link"><strong>Post link: </strong><a href="http://example.com/2021/04/19/mongodb-%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/" title="mongodb-åŸºæœ¬æ“ä½œ">http://example.com/2021/04/19/mongodb-%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/</a></li><li class="post-copyright-license"><strong>Copyright Notice: </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><svg class="icon"><use xlink:href="#icon-creative-commons-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-by-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-nc-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-sa-line"></use></svg></a> unless otherwise stated.</li></ul></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/2021/04/19/linux-%E8%BF%9B%E7%A8%8B%E5%92%8C%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1/" rel="prev" title="linux-è¿›ç¨‹å’Œç³»ç»ŸæœåŠ¡"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-left-s-line"></use></svg><span class="post-nav-text">linux-è¿›ç¨‹å’Œç³»ç»ŸæœåŠ¡</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/2021/04/19/mysql-%E4%B8%BB%E4%BB%8E%E6%90%AD%E5%BB%BA/" rel="next" title="mysql-ä¸»ä»æ­å»º"><span class="post-nav-text">mysql-ä¸»ä»æ­å»º</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-right-s-line"></use></svg></a></div></div></div><div class="hty-card" id="comment"><div class="comment-tooltip text-center"><span>å¦‚æœæ‚¨æœ‰ä»»ä½•å…³äºåšå®¢å†…å®¹çš„ç›¸å…³è®¨è®ºï¼Œæ¬¢è¿å‰å¾€ <a href="https://github.com/xiaolin-666/xiaolin-666.github.io/discussions" target="_blank">GitHub Discussions</a> ä¸æˆ‘äº¤æµã€‚</span><br></div></div></main><footer class="sidebar-translate" id="footer"><div class="beian"><a rel="noopener" href="https://beian.miit.gov.cn/" target="_blank">è‹ICPå¤‡17038157å·</a></div><div class="copyright"><span>&copy; 2016 â€“ 2022 </span><span class="with-love" id="animate"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-cloud-line"></use></svg></span><span class="author"> å°æ—</span></div><div class="powered"><span>Powered by <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> v5.4.1</span><span class="footer-separator">|</span><span>Theme - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.9.1</span></div><div class="footer-support"><span>æœ¬ç½‘ç«™ç”±</span><a class="footer-support-logo" href="https://www.upyun.com" target="blank" title="åˆæ‹äº‘"><img height="30" src="https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/logo/upyun-logo.png" alt="åˆæ‹äº‘"></a><span>æä¾› CDN åŠ é€Ÿ</span></div></footer><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-up-s-line"></use></svg><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a></div></body></html>